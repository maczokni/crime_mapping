<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Time matters | Crime Mapping and Spatial Data Analysis using R</title>
  <meta name="description" content="Chapter 7 Time matters | Crime Mapping and Spatial Data Analysis using R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Time matters | Crime Mapping and Spatial Data Analysis using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 7 Time matters | Crime Mapping and Spatial Data Analysis using R" />
  <meta name="github-repo" content="maczokni/crime_mapping" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Time matters | Crime Mapping and Spatial Data Analysis using R" />
  
  <meta name="twitter:description" content="Chapter 7 Time matters | Crime Mapping and Spatial Data Analysis using R" />
  

<meta name="author" content="Juanjo Medina and Reka Solymosi" />


<meta name="date" content="2021-11-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="visualisation-good-cartographic-design.html"/>
<link rel="next" href="chapter-7-spatial-point-patterns-of-crime-events.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<link href="libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet/leaflet.js"></script>
<link href="libs/leafletfix/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4/proj4.min.js"></script>
<script src="libs/Proj4Leaflet/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding/leaflet.js"></script>
<script src="libs/leaflet-providers/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin/leaflet-providers-plugin.js"></script>
<script src="libs/burglary_raster_cc_9107d3/data_stars_burglary_raster_cc983ce5.txt"></script>
<script src="libs/joda/joda.js"></script>
<script src="libs/joda/addImageQuery-bindings.js"></script>
<script src="libs/clipboard/setClipboardText.js"></script>
<link href="libs/HomeButton/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton/home-button.js"></script>
<script src="libs/HomeButton/easy-button-src.min.js"></script>
<link href="libs/mapviewCSS/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS/mapview.css" rel="stylesheet" />
<script src="libs/Leaflet.Sync/L.Map.Sync.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Crime Mapping and Spatial Data Analysis using R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble: how to use this book</a></li>
<li class="chapter" data-level="2" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html"><i class="fa fa-check"></i><b>2</b> Producing your first crime map</a>
<ul>
<li class="chapter" data-level="2.1" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#geospatial-perspective-key-terms-and-ideas"><i class="fa fa-check"></i><b>2.2</b> Geospatial Perspective: key terms and ideas</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#place"><i class="fa fa-check"></i><b>2.2.1</b> Place</a></li>
<li class="chapter" data-level="2.2.2" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#attributes"><i class="fa fa-check"></i><b>2.2.2</b> Attributes</a></li>
<li class="chapter" data-level="2.2.3" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#spatial-objects"><i class="fa fa-check"></i><b>2.2.3</b> Spatial objects</a></li>
<li class="chapter" data-level="2.2.4" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#networks"><i class="fa fa-check"></i><b>2.2.4</b> Networks</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#maps-and-their-types"><i class="fa fa-check"></i><b>2.3</b> Maps and their types</a></li>
<li class="chapter" data-level="2.4" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#map-projections-and-geographic-coordinate-systems"><i class="fa fa-check"></i><b>2.4</b> Map projections and geographic coordinate systems</a></li>
<li class="chapter" data-level="2.5" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#key-terms-summary"><i class="fa fa-check"></i><b>2.5</b> Key terms summary</a></li>
<li class="chapter" data-level="2.6" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#getting-started-with-crime-data"><i class="fa fa-check"></i><b>2.6</b> Getting started with crime data</a></li>
<li class="chapter" data-level="2.7" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#from-dataframes-to-spatial-objects"><i class="fa fa-check"></i><b>2.7</b> From dataframes to spatial objects</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#the-point"><i class="fa fa-check"></i><b>2.7.1</b> The point</a></li>
<li class="chapter" data-level="2.7.2" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#the-line"><i class="fa fa-check"></i><b>2.7.2</b> The line</a></li>
<li class="chapter" data-level="2.7.3" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#the-polygon"><i class="fa fa-check"></i><b>2.7.3</b> The polygon</a></li>
<li class="chapter" data-level="2.7.4" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#choosing-the-ideal-unit-of-analysis"><i class="fa fa-check"></i><b>2.7.4</b> Choosing the ideal unit of analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#the-simple-features-framework"><i class="fa fa-check"></i><b>2.8</b> The simple features framework</a></li>
<li class="chapter" data-level="2.9" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#plotting-data-with-ggplot2"><i class="fa fa-check"></i><b>2.9</b> Plotting data with ggplot2</a></li>
<li class="chapter" data-level="2.10" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#mapping-crime-data-as-points"><i class="fa fa-check"></i><b>2.10</b> Mapping crime data as points</a></li>
<li class="chapter" data-level="2.11" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#mapping-crime-data-as-polygons"><i class="fa fa-check"></i><b>2.11</b> Mapping crime data as polygons</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#finding-boundary-data"><i class="fa fa-check"></i><b>2.11.1</b> Finding boundary data</a></li>
<li class="chapter" data-level="2.11.2" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#reading-shapefiles-into-r"><i class="fa fa-check"></i><b>2.11.2</b> Reading shapefiles into R</a></li>
<li class="chapter" data-level="2.11.3" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#data-wrangling-with-dplyr"><i class="fa fa-check"></i><b>2.11.3</b> Data wrangling with dplyr</a></li>
<li class="chapter" data-level="2.11.4" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#join-data-to-sf-object"><i class="fa fa-check"></i><b>2.11.4</b> Join data to sf object</a></li>
<li class="chapter" data-level="2.11.5" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#putting-polygon-data-on-the-map"><i class="fa fa-check"></i><b>2.11.5</b> Putting polygon data on the map</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#summary-and-further-reading"><i class="fa fa-check"></i><b>2.12</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html"><i class="fa fa-check"></i><b>3</b> Basic geospatial operations in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#exploring-the-relationship-between-alcohol-outlets-and-crime"><i class="fa fa-check"></i><b>3.2</b> Exploring the relationship between alcohol outlets and crime</a></li>
<li class="chapter" data-level="3.3" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#acquiring-relevant-data"><i class="fa fa-check"></i><b>3.3</b> Acquiring relevant data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#reading-in-crime-data"><i class="fa fa-check"></i><b>3.3.1</b> Reading in crime data</a></li>
<li class="chapter" data-level="3.3.2" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#meet-a-new-format-geojson"><i class="fa fa-check"></i><b>3.3.2</b> Meet a new format: geoJSON</a></li>
<li class="chapter" data-level="3.3.3" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#open-street-map-and-points-of-interest"><i class="fa fa-check"></i><b>3.3.3</b> Open Street Map and points of interest</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#attribute-operations"><i class="fa fa-check"></i><b>3.4</b> Attribute operations</a></li>
<li class="chapter" data-level="3.5" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#spatial-operations"><i class="fa fa-check"></i><b>3.5</b> Spatial operations</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#reprojecting-coordinates"><i class="fa fa-check"></i><b>3.5.1</b> Reprojecting coordinates</a></li>
<li class="chapter" data-level="3.5.2" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#subsetting-points"><i class="fa fa-check"></i><b>3.5.2</b> Subsetting points</a></li>
<li class="chapter" data-level="3.5.3" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#building-buffers"><i class="fa fa-check"></i><b>3.5.3</b> Building buffers</a></li>
<li class="chapter" data-level="3.5.4" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#counting-points-within-a-polygon"><i class="fa fa-check"></i><b>3.5.4</b> Counting Points within a Polygon</a></li>
<li class="chapter" data-level="3.5.5" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#distances-finding-the-nearest-point"><i class="fa fa-check"></i><b>3.5.5</b> Distances: Finding the nearest point</a></li>
<li class="chapter" data-level="3.5.6" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#measuring-distances"><i class="fa fa-check"></i><b>3.5.6</b> Measuring distances</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#plotting-interactive-maps-with-leaflet"><i class="fa fa-check"></i><b>3.6</b> Plotting interactive maps with leaflet</a></li>
<li class="chapter" data-level="3.7" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#geocoding"><i class="fa fa-check"></i><b>3.7</b> Geocoding</a></li>
<li class="chapter" data-level="3.8" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#measuring-distance-more-thoroughly"><i class="fa fa-check"></i><b>3.8</b> Measuring distance more thoroughly</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#how-far-are-police-stations-in-madrid"><i class="fa fa-check"></i><b>3.8.1</b> How far are police stations in Madrid?</a></li>
<li class="chapter" data-level="3.8.2" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#distance-in-geographical-space"><i class="fa fa-check"></i><b>3.8.2</b> Distance in geographical space</a></li>
<li class="chapter" data-level="3.8.3" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#a-practical-example-to-evaluate-distance"><i class="fa fa-check"></i><b>3.8.3</b> A practical example to evaluate distance</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#summary-and-further-reading-1"><i class="fa fa-check"></i><b>3.9</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html"><i class="fa fa-check"></i><b>4</b> Mapping rates and counts</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#thematic-maps-key-terms-and-ideas"><i class="fa fa-check"></i><b>4.2</b> Thematic maps: key terms and ideas</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#choropleth-maps"><i class="fa fa-check"></i><b>4.2.1</b> Choropleth maps</a></li>
<li class="chapter" data-level="4.2.2" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#what-do-we-use-choropleth-maps-for"><i class="fa fa-check"></i><b>4.2.2</b> What do we use choropleth maps for?</a></li>
<li class="chapter" data-level="4.2.3" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#proportional-and-graduate-symbol-maps-mapping-crime-counts"><i class="fa fa-check"></i><b>4.2.3</b> Proportional and graduate symbol maps: mapping crime counts</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#creating-proportional-symbol-maps"><i class="fa fa-check"></i><b>4.3</b> Creating proportional symbol maps</a></li>
<li class="chapter" data-level="4.4" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#mapping-rates-rather-than-counts"><i class="fa fa-check"></i><b>4.4</b> Mapping rates rather than counts</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#generating-the-rates"><i class="fa fa-check"></i><b>4.4.1</b> Generating the rates</a></li>
<li class="chapter" data-level="4.4.2" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#creating-a-choropleth-map-with-tmap"><i class="fa fa-check"></i><b>4.4.2</b> Creating a choropleth map with tmap</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#classification-systems-for-thematic-maps"><i class="fa fa-check"></i><b>4.5</b> Classification systems for thematic maps</a></li>
<li class="chapter" data-level="4.6" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#interactive-mapping-with-tmap"><i class="fa fa-check"></i><b>4.6</b> Interactive mapping with tmap</a></li>
<li class="chapter" data-level="4.7" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#smoothing-rates-adjusting-for-small-sample-noise"><i class="fa fa-check"></i><b>4.7</b> Smoothing rates: adjusting for small sample noise</a></li>
<li class="chapter" data-level="4.8" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#summary-and-further-reading-2"><i class="fa fa-check"></i><b>4.8</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html"><i class="fa fa-check"></i><b>5</b> Variations of thematic mapping</a>
<ul>
<li class="chapter" data-level="5.1" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#binning-points"><i class="fa fa-check"></i><b>5.2</b> Binning points</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#the-binning-process"><i class="fa fa-check"></i><b>5.2.1</b> The Binning Process</a></li>
<li class="chapter" data-level="5.2.2" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#different-binning-techniques"><i class="fa fa-check"></i><b>5.2.2</b> Different Binning Techniques</a></li>
<li class="chapter" data-level="5.2.3" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#benefits-of-binning"><i class="fa fa-check"></i><b>5.2.3</b> Benefits of Binning</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#transforming-polygons"><i class="fa fa-check"></i><b>5.3</b> Transforming polygons</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#dorling-cartogram"><i class="fa fa-check"></i><b>5.3.1</b> Dorling Cartogram</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#bivariate-maps"><i class="fa fa-check"></i><b>5.4</b> Bivariate Maps</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#step-1-bin-our-variables-of-interest"><i class="fa fa-check"></i><b>5.4.1</b> Step 1: Bin our variables of interest</a></li>
<li class="chapter" data-level="5.4.2" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#step-2-new-variable"><i class="fa fa-check"></i><b>5.4.2</b> Step 2: New variable</a></li>
<li class="chapter" data-level="5.4.3" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#step-3-create-colour-scheme"><i class="fa fa-check"></i><b>5.4.3</b> Step 3: Create colour scheme</a></li>
<li class="chapter" data-level="5.4.4" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#step-4-join-colour-scheme"><i class="fa fa-check"></i><b>5.4.4</b> Step 4: Join colour scheme</a></li>
<li class="chapter" data-level="5.4.5" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#step-5-create-legend"><i class="fa fa-check"></i><b>5.4.5</b> Step 5: Create legend</a></li>
<li class="chapter" data-level="5.4.6" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#step-6-map"><i class="fa fa-check"></i><b>5.4.6</b> Step 6: Map</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#a-note-of-caution-maup"><i class="fa fa-check"></i><b>5.5</b> A note of caution: MAUP</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#why-does-maup-matter"><i class="fa fa-check"></i><b>5.5.1</b> Why does MAUP matter?</a></li>
<li class="chapter" data-level="5.5.2" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#what-can-we-do"><i class="fa fa-check"></i><b>5.5.2</b> What can we do?</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#summary-and-further-reading-3"><i class="fa fa-check"></i><b>5.6</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html"><i class="fa fa-check"></i><b>6</b> Visualisation: good cartographic design</a>
<ul>
<li class="chapter" data-level="6.1" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#data-representation"><i class="fa fa-check"></i><b>6.2</b> Data representation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#thematic-maps"><i class="fa fa-check"></i><b>6.2.1</b> Thematic maps</a></li>
<li class="chapter" data-level="6.2.2" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#symbols"><i class="fa fa-check"></i><b>6.2.2</b> Symbols</a></li>
<li class="chapter" data-level="6.2.3" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#rate-vs-count"><i class="fa fa-check"></i><b>6.2.3</b> Rate vs count</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#colour"><i class="fa fa-check"></i><b>6.3</b> Colour</a></li>
<li class="chapter" data-level="6.4" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#text"><i class="fa fa-check"></i><b>6.4</b> Text</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#titles-and-subtitles"><i class="fa fa-check"></i><b>6.4.1</b> Titles and subtitles</a></li>
<li class="chapter" data-level="6.4.2" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#legend"><i class="fa fa-check"></i><b>6.4.2</b> Legend</a></li>
<li class="chapter" data-level="6.4.3" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#annotation"><i class="fa fa-check"></i><b>6.4.3</b> Annotation</a></li>
<li class="chapter" data-level="6.4.4" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#production-notes"><i class="fa fa-check"></i><b>6.4.4</b> Production notes</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#composition"><i class="fa fa-check"></i><b>6.5</b> Composition</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#orientation-indicators"><i class="fa fa-check"></i><b>6.5.1</b> Orientation indicators</a></li>
<li class="chapter" data-level="6.5.2" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#scale-indicators"><i class="fa fa-check"></i><b>6.5.2</b> Scale indicators</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#context"><i class="fa fa-check"></i><b>6.6</b> Context</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#basemap"><i class="fa fa-check"></i><b>6.6.1</b> Basemap</a></li>
<li class="chapter" data-level="6.6.2" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#inset-maps"><i class="fa fa-check"></i><b>6.6.2</b> Inset maps</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="visualisation-good-cartographic-design.html"><a href="visualisation-good-cartographic-design.html#summary-and-further-reading-4"><i class="fa fa-check"></i><b>6.7</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-matters.html"><a href="time-matters.html"><i class="fa fa-check"></i><b>7</b> Time matters</a>
<ul>
<li class="chapter" data-level="7.1" data-path="time-matters.html"><a href="time-matters.html#introduction-5"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="time-matters.html"><a href="time-matters.html#temporal-data-in-crime-analysis"><i class="fa fa-check"></i><b>7.2</b> Temporal data in crime analysis</a></li>
<li class="chapter" data-level="7.3" data-path="time-matters.html"><a href="time-matters.html#temporal-data-wrangling"><i class="fa fa-check"></i><b>7.3</b> Temporal data wrangling</a></li>
<li class="chapter" data-level="7.4" data-path="time-matters.html"><a href="time-matters.html#visualising-time-data"><i class="fa fa-check"></i><b>7.4</b> Visualising time data</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="time-matters.html"><a href="time-matters.html#how-not-to-present-time"><i class="fa fa-check"></i><b>7.4.1</b> How (not) to present time</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="time-matters.html"><a href="time-matters.html#time-series-analysis"><i class="fa fa-check"></i><b>7.5</b> Time series analysis</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="time-matters.html"><a href="time-matters.html#plotting-time-series-data"><i class="fa fa-check"></i><b>7.5.1</b> Plotting time series data</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="time-matters.html"><a href="time-matters.html#spatio-temporal-data-visualisation"><i class="fa fa-check"></i><b>7.6</b> Spatio-temporal data visualisation</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="time-matters.html"><a href="time-matters.html#small-multiples-to-show-temporal-variation"><i class="fa fa-check"></i><b>7.6.1</b> Small multiples to show temporal variation</a></li>
<li class="chapter" data-level="7.6.2" data-path="time-matters.html"><a href="time-matters.html#spaghetti-plots"><i class="fa fa-check"></i><b>7.6.2</b> Spaghetti plots</a></li>
<li class="chapter" data-level="7.6.3" data-path="time-matters.html"><a href="time-matters.html#animations"><i class="fa fa-check"></i><b>7.6.3</b> Animations</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="time-matters.html"><a href="time-matters.html#summary-and-further-reading-5"><i class="fa fa-check"></i><b>7.7</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html"><i class="fa fa-check"></i><b>8</b> Chapter 7: Spatial point patterns of crime events</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html#mapping-crime-intensity-with-isarithmic-maps"><i class="fa fa-check"></i><b>8.1</b> Mapping crime intensity with isarithmic maps</a></li>
<li class="chapter" data-level="8.2" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html#burglaries-in-nyc"><i class="fa fa-check"></i><b>8.2</b> Burglaries in NYC</a></li>
<li class="chapter" data-level="8.3" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html#using-the-spatstat-package"><i class="fa fa-check"></i><b>8.3</b> Using the <code>spatstat</code> package</a></li>
<li class="chapter" data-level="8.4" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html#homogeneous-or-spatially-varying-intensity"><i class="fa fa-check"></i><b>8.4</b> Homogeneous or spatially varying intensity?</a></li>
<li class="chapter" data-level="8.5" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html#mapping-intensity-estimates-with-spatstat"><i class="fa fa-check"></i><b>8.5</b> Mapping intensity estimates with <code>spatstat</code></a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html#basics-of-kernel-density-estimation-kde"><i class="fa fa-check"></i><b>8.5.1</b> Basics of kernel density estimation (KDE)</a></li>
<li class="chapter" data-level="8.5.2" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html#selecting-the-appropriate-bandwith-for-kde"><i class="fa fa-check"></i><b>8.5.2</b> Selecting the appropriate bandwith for KDE</a></li>
<li class="chapter" data-level="8.5.3" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html#selecting-the-smoothing-kernel"><i class="fa fa-check"></i><b>8.5.3</b> Selecting the smoothing kernel</a></li>
<li class="chapter" data-level="8.5.4" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html#weighted-kernel-density-estimates"><i class="fa fa-check"></i><b>8.5.4</b> Weighted kernel density estimates</a></li>
<li class="chapter" data-level="8.5.5" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html#better-kde-maps-using-leaflet"><i class="fa fa-check"></i><b>8.5.5</b> Better KDE maps using <code>leaflet</code></a></li>
<li class="chapter" data-level="8.5.6" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html#problems-with-kde"><i class="fa fa-check"></i><b>8.5.6</b> Problems with KDE</a></li>
<li class="chapter" data-level="8.5.7" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html#other-packages-for-kde"><i class="fa fa-check"></i><b>8.5.7</b> Other packages for KDE</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="chapter-7-spatial-point-patterns-of-crime-events.html"><a href="chapter-7-spatial-point-patterns-of-crime-events.html#summary-and-further-reading-6"><i class="fa fa-check"></i><b>8.6</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html"><i class="fa fa-check"></i><b>9</b> Chapter 8: Crime along spatial networks</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#introduction-6"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#constructing-and-storing-a-spatial-linear-network"><i class="fa fa-check"></i><b>9.2</b> Constructing and storing a spatial linear network</a></li>
<li class="chapter" data-level="9.3" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#visualising-crime-distribution-along-networks"><i class="fa fa-check"></i><b>9.3</b> Visualising crime distribution along networks</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#selecting-relevant-crimes-for-micro-places"><i class="fa fa-check"></i><b>9.3.1</b> Selecting relevant crimes for micro-places</a></li>
<li class="chapter" data-level="9.3.2" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#assigning-joining-crimes-to-micro-places"><i class="fa fa-check"></i><b>9.3.2</b> Assigning (joining) crimes to micro-places</a></li>
<li class="chapter" data-level="9.3.3" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#calculating-a-crime-rate"><i class="fa fa-check"></i><b>9.3.3</b> Calculating a crime rate</a></li>
<li class="chapter" data-level="9.3.4" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#hot-routes"><i class="fa fa-check"></i><b>9.3.4</b> Hot Routes</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#quantifying-crime-concentration-at-micro-places"><i class="fa fa-check"></i><b>9.4</b> Quantifying crime concentration at micro-places</a></li>
<li class="chapter" data-level="9.5" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#street-profile-analysis"><i class="fa fa-check"></i><b>9.5</b> Street Profile Analysis</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#linking-data-to-nodes"><i class="fa fa-check"></i><b>9.5.1</b> Linking data to nodes</a></li>
<li class="chapter" data-level="9.5.2" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#calculating-a-rate-for-nodes"><i class="fa fa-check"></i><b>9.5.2</b> Calculating a rate for nodes</a></li>
<li class="chapter" data-level="9.5.3" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#visualising-with-street-profile-analysis"><i class="fa fa-check"></i><b>9.5.3</b> Visualising with Street Profile Analysis</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#density-estimation-along-networks"><i class="fa fa-check"></i><b>9.6</b> Density estimation along networks</a></li>
<li class="chapter" data-level="9.7" data-path="chapter-8-crime-along-spatial-networks.html"><a href="chapter-8-crime-along-spatial-networks.html#summary-and-further-reading-7"><i class="fa fa-check"></i><b>9.7</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html"><i class="fa fa-check"></i><b>10</b> Chapter 9: Spatial dependence and autocorrelation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#introduction-7"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#exploring-spatial-dependence-in-point-pattern-data"><i class="fa fa-check"></i><b>10.2</b> Exploring spatial dependence in point pattern data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#the-empirical-k-function"><i class="fa fa-check"></i><b>10.2.1</b> The empirical K function</a></li>
<li class="chapter" data-level="10.2.2" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#homicide-in-buenos-aires"><i class="fa fa-check"></i><b>10.2.2</b> Homicide in Buenos Aires</a></li>
<li class="chapter" data-level="10.2.3" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#estimating-and-plotting-the-k-function"><i class="fa fa-check"></i><b>10.2.3</b> Estimating and plotting the K-function</a></li>
<li class="chapter" data-level="10.2.4" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#network-constrained-k-function"><i class="fa fa-check"></i><b>10.2.4</b> Network constrained K function</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#exploring-spatial-autocorrelation-in-lattice-data"><i class="fa fa-check"></i><b>10.3</b> Exploring spatial autocorrelation in lattice data</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#burglary-in-manchester"><i class="fa fa-check"></i><b>10.3.1</b> Burglary in Manchester</a></li>
<li class="chapter" data-level="10.3.2" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#what-is-a-neighbour"><i class="fa fa-check"></i><b>10.3.2</b> What is a neighbour?</a></li>
<li class="chapter" data-level="10.3.3" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#creating-a-list-of-neighbours-based-on-contiguity"><i class="fa fa-check"></i><b>10.3.3</b> Creating a list of neighbours based on contiguity</a></li>
<li class="chapter" data-level="10.3.4" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#generating-the-weight-matrix"><i class="fa fa-check"></i><b>10.3.4</b> Generating the weight matrix</a></li>
<li class="chapter" data-level="10.3.5" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#spatial-weight-matrix-based-on-distance"><i class="fa fa-check"></i><b>10.3.5</b> Spatial weight matrix based on distance</a></li>
<li class="chapter" data-level="10.3.6" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#spatial-weight-matrix-based-on-k-neighbors"><i class="fa fa-check"></i><b>10.3.6</b> Spatial weight matrix based on k-neighbors</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#choosing-the-correct-matrix"><i class="fa fa-check"></i><b>10.4</b> Choosing the correct matrix</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#measuring-global-autocorrelation"><i class="fa fa-check"></i><b>10.4.1</b> Measuring global autocorrelation</a></li>
<li class="chapter" data-level="10.4.2" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#the-rgeoda-and-sfweight-packages"><i class="fa fa-check"></i><b>10.4.2</b> The <code>rgeoda</code> and <code>sfweight</code> packages</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="chapter-9-spatial-dependence-and-autocorrelation.html"><a href="chapter-9-spatial-dependence-and-autocorrelation.html#further-reading"><i class="fa fa-check"></i><b>10.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html"><i class="fa fa-check"></i><b>11</b> Chapter 10: Detecting hot spots and repeats</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#introduction-8"><i class="fa fa-check"></i><b>11.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#clusters-hot-spots-of-crime-and-near-repeat-victimisation"><i class="fa fa-check"></i><b>11.1.1</b> Clusters, hot spots of crime, and near repeat victimisation</a></li>
<li class="chapter" data-level="11.1.2" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#burglaries-in-manchester"><i class="fa fa-check"></i><b>11.1.2</b> Burglaries in Manchester</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#using-raster-micro-grid-cells-to-spot-hot-spots"><i class="fa fa-check"></i><b>11.2</b> Using <code>raster</code> micro grid cells to spot hot spots</a></li>
<li class="chapter" data-level="11.3" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#local-getis-ord"><i class="fa fa-check"></i><b>11.3</b> Local Getis-Ord</a></li>
<li class="chapter" data-level="11.4" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#local-morans-i-and-moran-scaterplot"><i class="fa fa-check"></i><b>11.4</b> Local Moran’s I and Moran scaterplot</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#computing-the-local-morans-i"><i class="fa fa-check"></i><b>11.4.1</b> Computing the local Moran’s I</a></li>
<li class="chapter" data-level="11.4.2" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#creating-a-lisa-map"><i class="fa fa-check"></i><b>11.4.2</b> Creating a LISA map</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#scan-satistics"><i class="fa fa-check"></i><b>11.5</b> Scan satistics</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#the-dcluster-package"><i class="fa fa-check"></i><b>11.5.1</b> The <code>DCluster</code> package</a></li>
<li class="chapter" data-level="11.5.2" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#openshaws-gam"><i class="fa fa-check"></i><b>11.5.2</b> Openshaw’s GAM</a></li>
<li class="chapter" data-level="11.5.3" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#kulldorfs-scan-statistic"><i class="fa fa-check"></i><b>11.5.3</b> Kulldorf’s Scan Statistic</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#exploring-near-repeat-victimisation"><i class="fa fa-check"></i><b>11.6</b> Exploring near repeat victimisation</a></li>
<li class="chapter" data-level="11.7" data-path="chapter-10-detecting-hot-spots-and-repeats.html"><a href="chapter-10-detecting-hot-spots-and-repeats.html#further-reading-1"><i class="fa fa-check"></i><b>11.7</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chapter-11-spatial-regression-models.html"><a href="chapter-11-spatial-regression-models.html"><i class="fa fa-check"></i><b>12</b> Chapter 11: Spatial regression models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="chapter-11-spatial-regression-models.html"><a href="chapter-11-spatial-regression-models.html#introduction-9"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="chapter-11-spatial-regression-models.html"><a href="chapter-11-spatial-regression-models.html#challenges-for-regression-with-spatial-data"><i class="fa fa-check"></i><b>12.2</b> Challenges for regression with spatial data</a></li>
<li class="chapter" data-level="12.3" data-path="chapter-11-spatial-regression-models.html"><a href="chapter-11-spatial-regression-models.html#fitting-a-non-spatial-regression-model-with-r"><i class="fa fa-check"></i><b>12.3</b> Fitting a non-spatial regression model with R</a></li>
<li class="chapter" data-level="12.4" data-path="chapter-11-spatial-regression-models.html"><a href="chapter-11-spatial-regression-models.html#looking-at-the-residuals-and-testing-for-spatial-autocorrelation-in-regression"><i class="fa fa-check"></i><b>12.4</b> Looking at the residuals and testing for spatial autocorrelation in regression</a></li>
<li class="chapter" data-level="12.5" data-path="chapter-11-spatial-regression-models.html"><a href="chapter-11-spatial-regression-models.html#choosing-a-spatial-regression-model"><i class="fa fa-check"></i><b>12.5</b> Choosing a spatial regression model</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="chapter-11-spatial-regression-models.html"><a href="chapter-11-spatial-regression-models.html#the-basic-spatial-models"><i class="fa fa-check"></i><b>12.5.1</b> The basic spatial models</a></li>
<li class="chapter" data-level="12.5.2" data-path="chapter-11-spatial-regression-models.html"><a href="chapter-11-spatial-regression-models.html#lagrange-multipliers-the-bottom-up-approach-to-select-a-model"><i class="fa fa-check"></i><b>12.5.2</b> Lagrange multipliers: the bottom-up approach to select a model</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="chapter-11-spatial-regression-models.html"><a href="chapter-11-spatial-regression-models.html#fitting-and-interpreting-a-spatial-error-model"><i class="fa fa-check"></i><b>12.6</b> Fitting and interpreting a spatial error model</a></li>
<li class="chapter" data-level="12.7" data-path="chapter-11-spatial-regression-models.html"><a href="chapter-11-spatial-regression-models.html#fitting-and-interpreting-a-spatially-lagged-model"><i class="fa fa-check"></i><b>12.7</b> Fitting and interpreting a spatially lagged model</a></li>
<li class="chapter" data-level="12.8" data-path="chapter-11-spatial-regression-models.html"><a href="chapter-11-spatial-regression-models.html#beyond-the-sar-and-sem-models"><i class="fa fa-check"></i><b>12.8</b> Beyond the SAR and SEM models</a></li>
<li class="chapter" data-level="12.9" data-path="chapter-11-spatial-regression-models.html"><a href="chapter-11-spatial-regression-models.html#summary-and-further-reading-8"><i class="fa fa-check"></i><b>12.9</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chapter-12-spatial-heterogeneity-and-regression.html"><a href="chapter-12-spatial-heterogeneity-and-regression.html"><i class="fa fa-check"></i><b>13</b> Chapter 12: Spatial heterogeneity and regression</a>
<ul>
<li class="chapter" data-level="13.1" data-path="chapter-12-spatial-heterogeneity-and-regression.html"><a href="chapter-12-spatial-heterogeneity-and-regression.html#introduction-10"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="chapter-12-spatial-heterogeneity-and-regression.html"><a href="chapter-12-spatial-heterogeneity-and-regression.html#spatial-regimes"><i class="fa fa-check"></i><b>13.2</b> Spatial regimes</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="chapter-12-spatial-heterogeneity-and-regression.html"><a href="chapter-12-spatial-heterogeneity-and-regression.html#fitting-the-constrained-and-the-unconstrained-models"><i class="fa fa-check"></i><b>13.2.1</b> Fitting the constrained and the unconstrained models</a></li>
<li class="chapter" data-level="13.2.2" data-path="chapter-12-spatial-heterogeneity-and-regression.html"><a href="chapter-12-spatial-heterogeneity-and-regression.html#running-the-chow-test"><i class="fa fa-check"></i><b>13.2.2</b> Running the Chow test</a></li>
<li class="chapter" data-level="13.2.3" data-path="chapter-12-spatial-heterogeneity-and-regression.html"><a href="chapter-12-spatial-heterogeneity-and-regression.html#spatial-dependence-with-spatial-heterogeneity"><i class="fa fa-check"></i><b>13.2.3</b> Spatial dependence with spatial heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="chapter-12-spatial-heterogeneity-and-regression.html"><a href="chapter-12-spatial-heterogeneity-and-regression.html#geographically-weighted-regression"><i class="fa fa-check"></i><b>13.3</b> Geographically Weighted Regression</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="chapter-12-spatial-heterogeneity-and-regression.html"><a href="chapter-12-spatial-heterogeneity-and-regression.html#calculate-kernel-bandwidth"><i class="fa fa-check"></i><b>13.3.1</b> Calculate kernel bandwidth</a></li>
<li class="chapter" data-level="13.3.2" data-path="chapter-12-spatial-heterogeneity-and-regression.html"><a href="chapter-12-spatial-heterogeneity-and-regression.html#building-the-geographically-weighted-model"><i class="fa fa-check"></i><b>13.3.2</b> Building the geographically weighted model</a></li>
<li class="chapter" data-level="13.3.3" data-path="chapter-12-spatial-heterogeneity-and-regression.html"><a href="chapter-12-spatial-heterogeneity-and-regression.html#using-gwr"><i class="fa fa-check"></i><b>13.3.3</b> Using GWR</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="chapter-12-spatial-heterogeneity-and-regression.html"><a href="chapter-12-spatial-heterogeneity-and-regression.html#summary-and-further-reading-9"><i class="fa fa-check"></i><b>13.4</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>14</b> Appendix: A quick intro to R and RStudio</a>
<ul>
<li class="chapter" data-level="14.1" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#exploring-rstudio"><i class="fa fa-check"></i><b>14.1</b> Exploring RStudio</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#the-four-panes-of-r-studio"><i class="fa fa-check"></i><b>14.1.1</b> The four panes of R Studio</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#customising-the-rstudio-look"><i class="fa fa-check"></i><b>14.2</b> Customising the RStudio look</a></li>
<li class="chapter" data-level="14.3" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#elements-of-r-grammar"><i class="fa fa-check"></i><b>14.3</b> Elements of R grammar</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#functions"><i class="fa fa-check"></i><b>14.3.1</b> Functions</a></li>
<li class="chapter" data-level="14.3.2" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#objects"><i class="fa fa-check"></i><b>14.3.2</b> Objects</a></li>
<li class="chapter" data-level="14.3.3" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#types-of-objects"><i class="fa fa-check"></i><b>14.3.3</b> Types of objects</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#packages"><i class="fa fa-check"></i><b>14.4</b> Packages</a></li>
<li class="chapter" data-level="14.5" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#exploring-data-with-r"><i class="fa fa-check"></i><b>14.5</b> Exploring data with R</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#playing-around-with-data"><i class="fa fa-check"></i><b>14.5.1</b> Playing around with data</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#getting-organised-r-projects"><i class="fa fa-check"></i><b>14.6</b> Getting organised: R Projects</a></li>
<li class="chapter" data-level="14.7" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#summary-and-further-reading-10"><i class="fa fa-check"></i><b>14.7</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html"><i class="fa fa-check"></i><b>15</b> Appendix B: Regression analysis (a refresher)</a>
<ul>
<li class="chapter" data-level="15.1" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#introduction-11"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#motivating-regression"><i class="fa fa-check"></i><b>15.2</b> Motivating regression</a></li>
<li class="chapter" data-level="15.3" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#fitting-a-simple-regression-model"><i class="fa fa-check"></i><b>15.3</b> Fitting a simple regression model</a></li>
<li class="chapter" data-level="15.4" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#residuals-revisited-r-squared"><i class="fa fa-check"></i><b>15.4</b> Residuals revisited: R squared</a></li>
<li class="chapter" data-level="15.5" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#inference-with-regression"><i class="fa fa-check"></i><b>15.5</b> Inference with regression</a></li>
<li class="chapter" data-level="15.6" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#fitting-regression-with-categorical-predictors"><i class="fa fa-check"></i><b>15.6</b> Fitting regression with categorical predictors</a></li>
<li class="chapter" data-level="15.7" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#motivating-multiple-regression"><i class="fa fa-check"></i><b>15.7</b> Motivating multiple regression</a></li>
<li class="chapter" data-level="15.8" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#fitting-and-interpreting-a-multiple-regression-model"><i class="fa fa-check"></i><b>15.8</b> Fitting and interpreting a multiple regression model</a></li>
<li class="chapter" data-level="15.9" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#presenting-your-regression-results."><i class="fa fa-check"></i><b>15.9</b> Presenting your regression results.</a></li>
<li class="chapter" data-level="15.10" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#rescaling-input-variables-to-assist-interpretation"><i class="fa fa-check"></i><b>15.10</b> Rescaling input variables to assist interpretation</a></li>
<li class="chapter" data-level="15.11" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#testing-conditional-hypothesis-interactions"><i class="fa fa-check"></i><b>15.11</b> Testing conditional hypothesis: interactions</a></li>
<li class="chapter" data-level="15.12" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#model-building-and-variable-selection"><i class="fa fa-check"></i><b>15.12</b> Model building and variable selection</a></li>
<li class="chapter" data-level="15.13" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#regression-assumptions"><i class="fa fa-check"></i><b>15.13</b> Regression assumptions</a></li>
<li class="chapter" data-level="15.14" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#summary-and-further-reading-11"><i class="fa fa-check"></i><b>15.14</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><i class="fa fa-check"></i><b>16</b> Appendix C: sourcing geographical data for crime analysis</a>
<ul>
<li class="chapter" data-level="16.1" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html#the-rnaturalearth-package"><i class="fa fa-check"></i><b>16.1</b> The rnaturalearth package</a></li>
<li class="chapter" data-level="16.2" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html#data-from-apis"><i class="fa fa-check"></i><b>16.2</b> Data from APIs</a></li>
<li class="chapter" data-level="16.3" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html#data-from-data-repositories"><i class="fa fa-check"></i><b>16.3</b> Data from data repositories</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html#international-resources"><i class="fa fa-check"></i><b>16.3.1</b> International resources</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html#open-street-map"><i class="fa fa-check"></i><b>16.4</b> Open Street Map</a></li>
<li class="chapter" data-level="16.5" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html#summary-and-further-reading-12"><i class="fa fa-check"></i><b>16.5</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Crime Mapping and Spatial Data Analysis using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="time-matters" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Time matters</h1>
<div id="introduction-5" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Introduction</h2>
<p>In this chapter we provide a brief introduction into spatio-temporal visualisation. The importance of place in criminology and crime analysis is widely recognised, and is the central topic of this book. However, taking into consideration <strong>time</strong> is just as important as place. We often hear that crime is “going up” or “going down” over time. These variations on the levels of crime along time also vary across space. These variations across both time and place are called <strong>spatio-temporal variations</strong>, and are of crucial importance for crime analysis, explanation, and prevention.</p>
<p>Traditionally the temporal and spatial analysis of crime are not introduced in a combined manner. Although a great deal of energy has been devoted to produce accessible training material for crime analysts on geographic information systems and spatial analysis, most criminology degrees (even at postgraduate level) and training packages for crime analysis devote a very limited (if any) content to the appropriate visualisation and analysis of temporal and spatio-temporal data. Therefore, before we discuss the spatio-temporal, we have to introduce a few key ideas and concepts about temporal crime analysis.</p>
<p>In this chapter, we will therefore give a very high-level overview of <strong>temporal crime analysis</strong>, before moving on to ways in which we can display spatio-temporal variation in our data using maps. The key concepts covered in this chapter are:</p>
<ul>
<li>an introduction to temporal data in crime analysis,</li>
<li>cleaning and wrangling temporal data,</li>
<li>visualising time data,</li>
<li>time series and its three components: trend, seasonality, and random variation,</li>
<li>visualising spatio-temporal variation.</li>
</ul>
<p>We will be making use of the following R packages:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="time-matters.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic reading and data carpentry</span></span>
<span id="cb260-2"><a href="time-matters.html#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb260-3"><a href="time-matters.html#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb260-4"><a href="time-matters.html#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># adds functionality for better handling of temporal data</span></span>
<span id="cb260-5"><a href="time-matters.html#cb260-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-6"><a href="time-matters.html#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages for handling spatial data</span></span>
<span id="cb260-7"><a href="time-matters.html#cb260-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb260-8"><a href="time-matters.html#cb260-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spacetime)</span>
<span id="cb260-9"><a href="time-matters.html#cb260-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb260-10"><a href="time-matters.html#cb260-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-11"><a href="time-matters.html#cb260-11" aria-hidden="true" tabindex="-1"></a><span class="co"># General visualisation and ggplot plugins for temporal data</span></span>
<span id="cb260-12"><a href="time-matters.html#cb260-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb260-13"><a href="time-matters.html#cb260-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb260-14"><a href="time-matters.html#cb260-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggTimeSeries)</span>
<span id="cb260-15"><a href="time-matters.html#cb260-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggseas)</span>
<span id="cb260-16"><a href="time-matters.html#cb260-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb260-17"><a href="time-matters.html#cb260-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span></code></pre></div>
</div>
<div id="temporal-data-in-crime-analysis" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Temporal data in crime analysis</h2>
<p>In this book so far we have really emphasised the role of place in presenting opportunities for crimes to occur. However we cannot consider space without also considering time. An area might look very different during the day and during the night, on a weekend or on a weekday, and in the summer or in the winter.</p>
<p>On a macro-scale, the relationship between crime and the seasons is something that had been a topic of concern for researchers as long as space has <span class="citation">(<a href="#ref-Baumer_1996" role="doc-biblioref">Baumer and Wright 1996</a>)</span>. Zooming into a micro-scale, changes in routine activities with time of day or day of week will affect the profile of a place, and linking back to the idea of crime places such as <em>generators</em> or <em>attractors</em>, will have significant effect on crime rates. In conceptualising these crime places, <span class="citation"><a href="#ref-Newton_2018" role="doc-biblioref">Newton</a> (<a href="#ref-Newton_2018" role="doc-biblioref">2018</a>)</span> emphasised the importance to consider the measure of busyness of a place by time of day in order to understand its role as an attractor, generator, or other crime place. For example, at transit stations during school days there is a morning peak time of work and school users combined, an afternoon school closing peak, and a secondary and slightly later end-of-workday peak time. Any calculation of crime rates needs to account for these micro-level temporal variations.</p>
<p>At whatever unit of analysis, time is a vital variable to include in our crime analysis and criminological research. To quote <span class="citation"><a href="#ref-Tompson_2013" role="doc-biblioref">Tompson and Bowers</a> (<a href="#ref-Tompson_2013" role="doc-biblioref">2013</a>)</span>:</p>
<blockquote>
<p>“[I]t is important to disaggregate data into sensible temporal categories to have a real understanding of the relationship between the variables under scrutiny” (p.627).</p>
</blockquote>
<p>Returning to the importance of the role of place, we can introduce <strong>spatio-temporal data</strong> analysis. Spatio-temporal analysis is the process of utilising geo-and-time-referenced data in order to extract meaning and patterns from our data. In the earlier days, crime pattern analysis has tended to focus on identifying areas with higher densities of criminal activity, but not so much the monitoring of change in crime patterns over time <span class="citation">(<a href="#ref-Ratcliffe_1998" role="doc-biblioref">Ratcliffe and McCullagh 1998</a>)</span>. However, crime hotspots display significant spatio-temporal variance, and the identification of spatio-temporal patterns of hot streets provides significant ‘actionable intelligence’ for police departments <span class="citation">(<a href="#ref-Herrmann_2013" role="doc-biblioref">Herrmann 2013</a>)</span>. Evidently, we cannot ignore time as a variable in our analyses. And while the main focus of this book is space, we must take at least one chapter to introduce some key concepts, and provide additional resources for readers to follow up with.</p>
</div>
<div id="temporal-data-wrangling" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Temporal data wrangling</h2>
<p>Temporal data means that we can perform all sorts of exciting operations in our data wrangling processes. Just how we learned about spatial operations with spatial data, there are some things we can do only with temporal data. In this section we will introduce some of these.</p>
<p>A key R package that will help with temporal data wrangling is <code>lubridate</code>. Date-time data can be frustrating to work with and many base R commands for date-times can be unintuitive. The package <code>lubridate</code> was created to address such issues, and make it easier to do the things R does with date-times.</p>
<p>For crime data, we will be using crime data from New York City made available by the R package <code>crimedata</code> <span class="citation"><a href="#ref-Ashby_2019" role="doc-biblioref">Ashby</a> (<a href="#ref-Ashby_2019" role="doc-biblioref">2019</a>)</span>. You can refer to these citations to learn more about acquiring data from this fantastic resource! However for now, let’s make use of the data provided with the book, where we selected a specific subset of aggravated assault in New York for a period of five years.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="time-matters.html#cb261-1" aria-hidden="true" tabindex="-1"></a>agassault_ny<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">&quot;data/agassault.csv&quot;</span>)</span></code></pre></div>
<p>When you read the data into R, you will see that there is a column for date called <strong>date_single</strong>. Let’s have a look at the first value in this column:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="time-matters.html#cb262-1" aria-hidden="true" tabindex="-1"></a>agassault_ny <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">select</span>(date_single) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   date_single        
##   &lt;dttm&gt;             
## 1 2014-01-01 00:03:00</code></pre>
<p>We can see that the date is stored in the following format: year-month-day hour-minute-second. So the first date on there you can see is <em>2014-01-01 00:03:00</em>. What kind of variable is this?</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="time-matters.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(agassault_ny<span class="sc">$</span>date_single)</span></code></pre></div>
<pre><code>## [1] &quot;POSIXct&quot; &quot;POSIXt&quot;</code></pre>
<p>Our date and time variables are of class <code>POSIXct</code> and <code>POSIXt</code>. These are the two basic classes of date/times. Class “POSIXct” represents the (signed) <a href="https://en.wikipedia.org/wiki/Unix_time">number of seconds since the beginning of 1970</a> as a numeric vector. Class “POSIXt” is a named list of vectors representing seconds (0–61), minutes (0–59), hours (0–23), day of the month (1–31), months after the first of the year (0–11), years since 1900, day of the week, starting on Sunday (0–6), and a flag for whether it is daylight savings time or not (positive if in force, zero if not, negative if unknown).</p>
<p>Let’s plot this data:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="time-matters.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(agassault_ny, <span class="fu">aes</span>(date_single)) <span class="sc">+</span> </span>
<span id="cb266-2"><a href="time-matters.html#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="dv">7</span><span class="sc">*</span><span class="dv">24</span><span class="sc">*</span><span class="dv">60</span><span class="sc">*</span><span class="dv">60</span>) <span class="co"># 7 days in seconds</span></span></code></pre></div>
<div class="figure">
<img src="crime_mapping_files/figure-html/ggplot_8b-1.png" alt="Number of assaults aggregated to 7-day chunks" width="672" />
<p class="caption">
(#fig:ggplot_8b)Number of assaults aggregated to 7-day chunks
</p>
</div>
<p>Notice what <code>geom_freqpoly()</code> is doing. We have a dataframe with rows for each case. The data is not aggregated in any form. But this function counts on the fly the number of cases (of rows) for each of the bins as we define them. It is, thus, a convenient function that saves us from having to first do that aggregation ourselves when we want to plot it.</p>
<p>An alternative approach to plotting individual components is to round the date to a nearby unit of time, with <code>floor_date()</code>, <code>round_date()</code>, and <code>ceiling_date()</code>. These functions live inside the lubridate package.</p>
<p>Each function takes a vector of dates to adjust and then the name of the unit round down (floor), round up (ceiling), or round to. So to aggregate per month we will code as:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="time-matters.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb267-2"><a href="time-matters.html#cb267-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-3"><a href="time-matters.html#cb267-3" aria-hidden="true" tabindex="-1"></a>agassault_ny <span class="sc">%&gt;%</span> </span>
<span id="cb267-4"><a href="time-matters.html#cb267-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="at">month =</span> <span class="fu">floor_date</span>(date_single, <span class="st">&quot;month&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># use floor date function</span></span>
<span id="cb267-5"><a href="time-matters.html#cb267-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(month, n)) <span class="sc">+</span></span>
<span id="cb267-6"><a href="time-matters.html#cb267-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code></pre></div>
<div class="figure">
<img src="crime_mapping_files/figure-html/ggplot_rounding_8b-1.png" alt="Number of assaults aggregated to Month" width="672" />
<p class="caption">
(#fig:ggplot_rounding_8b)Number of assaults aggregated to Month
</p>
</div>
<p>What if I asked you the question: which year had the most aggravated assaults? Or what if I want to know if aggravated assaults happen more in the weekday, when people are at work, or in the weekends, maybe when people are away for a holiday? You have the date, so you should be able to answer these questions, right?</p>
<p>Well you need to be able to have the right variables to answer these questions. To know what year saw the most aggravated assaults, you need to have a variable for year. To know what day of the week has the most aggravated assaults, you need to have a variable for day of the week. So how can we extract these variables from your date column? Well luckily the <code>lubridate</code> package can help us do this. We can use the <code>year()</code>, <code>month()</code>, <code>day()</code>, and <code>wday()</code> to extract these components of a date-time.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="time-matters.html#cb268-1" aria-hidden="true" tabindex="-1"></a>agassault_ny <span class="ot">&lt;-</span> agassault_ny <span class="sc">%&gt;%</span> </span>
<span id="cb268-2"><a href="time-matters.html#cb268-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date_single), <span class="co"># extract year</span></span>
<span id="cb268-3"><a href="time-matters.html#cb268-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">month =</span> <span class="fu">month</span>(date_single, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr=</span><span class="cn">FALSE</span>), <span class="co"># month</span></span>
<span id="cb268-4"><a href="time-matters.html#cb268-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">day =</span> <span class="fu">day</span>(date_single), <span class="co"># extract day</span></span>
<span id="cb268-5"><a href="time-matters.html#cb268-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">wday =</span> <span class="fu">wday</span>(date_single, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr=</span><span class="cn">FALSE</span>) ) <span class="co"># extract day of week</span></span></code></pre></div>
<p>We have now created a set of additional variables that have extracted information from your original time of occurrence variable.</p>
<p>Let’s consider distribution of events per day of the week.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="time-matters.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(agassault_ny, <span class="fu">aes</span>(<span class="at">x =</span> wday)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="crime_mapping_files/figure-html/assaults_per_wday-1.png" width="672" /></p>
<p>In order to extract such date-time information from variables, we need these to be date-time objects. We saw above that in this case this assumption was met. However if it is not, you can turn text column of dates into a date-time object using lubridate’s functions. For example if you have a data set of day-month-year separated with “/,” you can use the <code>dmy()</code> function (stands for day month year) to parse it as a date-time object. On the other hand, if you have some US data, and it is actually written as month-day-year, separated by “/,” you can simply shuffle the order of the letters in the function, and use the function <code>mdy()</code>. They will translate into the same item. See for yourself:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="time-matters.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dmy</span>(<span class="st">&quot;15/3/2021&quot;</span>) <span class="sc">==</span> <span class="fu">mdy</span>(<span class="st">&quot;3/15/2021&quot;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>In fact, <code>lubridate</code> is so good, it can even parse text representations of months. Look at this for example:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="time-matters.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dmy</span>(<span class="st">&quot;15/3/2021&quot;</span>) <span class="sc">==</span> <span class="fu">mdy</span>(<span class="st">&quot;March/15/2021&quot;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Amazing stuff, which will definitely come in handy, especially if you might be a crime analyst working with some messy messy data. Lubridate should most definitely form part of your data wrangling toolkit in this case!</p>
<!-- The `lubridate` package is incredibly helpful for anything date related. There is also a more recent package `clock` that has only recently being released and solves some problems with...  [[[]]] -->
</div>
<div id="visualising-time-data" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Visualising time data</h2>
<p>Once we have parsed and cleaned the temporal information that is available in our date variable, we can make use of this to visualise trends in other ways, not just using time series. For example, we might want to show where hotspots in time occur, within a year, or within a week, or some other set interval.</p>
<p>One approach for this is to use a calendar heatmap.</p>
<p>First, we create a column for date, removing the time (hour minute and second). We can achieve this easily by using the <code>date()</code> function in <code>lubridate</code>:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="time-matters.html#cb274-1" aria-hidden="true" tabindex="-1"></a>agassault_ny<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">date</span>(agassault_ny<span class="sc">$</span>date_single)</span></code></pre></div>
<p>If we have a look we can now see that the time component has been stripped away, and we have this date object. Let’s look at the value for the first row.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="time-matters.html#cb275-1" aria-hidden="true" tabindex="-1"></a>agassault_ny<span class="sc">$</span>date[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] &quot;2014-01-01&quot;</code></pre>
<p>That looks like what we are expecting. Now let’s see the class of this variable.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="time-matters.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(agassault_ny<span class="sc">$</span>date)</span></code></pre></div>
<pre><code>## [1] &quot;Date&quot;</code></pre>
<p>It is a date object, so we will be able to do date-time operations to it. Good stuff. Now what we want to do is create a heatmap, a sort of calendar, of the number of aggrevated assault incidents per date. We can use our well known attribute operations here, specifically the <code>group_by()</code> function in the <code>dplyr</code> packate to count the events per day.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="time-matters.html#cb279-1" aria-hidden="true" tabindex="-1"></a>agassault_ny_d <span class="ot">&lt;-</span> agassault_ny <span class="sc">%&gt;%</span></span>
<span id="cb279-2"><a href="time-matters.html#cb279-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">assaults =</span> <span class="fu">n</span>())</span></code></pre></div>
<p>Now we have this new dataframe, the number of aggravated assaults per day. To make our temporal heatmap calendar, we will now use a <code>ggplot2</code> extension, <code>ggTimeSeries</code>, that allows us to produce calendar heat visualisations. In this package, we can use the <code>ggplot_calendar_heatmap()</code> function, which creates a calendar heatmap. This approach provides context for weeks, and day of week which makes it a better way to visualise daily data than line charts.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="time-matters.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggTimeSeries)</span>
<span id="cb280-2"><a href="time-matters.html#cb280-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-3"><a href="time-matters.html#cb280-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_calendar_heatmap</span>(</span>
<span id="cb280-4"><a href="time-matters.html#cb280-4" aria-hidden="true" tabindex="-1"></a>   agassault_ny_d,  <span class="co"># our dataset of dates and number of crimes</span></span>
<span id="cb280-5"><a href="time-matters.html#cb280-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">cDateColumnName =</span> <span class="st">&#39;date&#39;</span>, <span class="co"># column name of the dates</span></span>
<span id="cb280-6"><a href="time-matters.html#cb280-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">cValueColumnName =</span> <span class="st">&#39;assaults&#39;</span>) <span class="sc">+</span> <span class="co"># column name of the data</span></span>
<span id="cb280-7"><a href="time-matters.html#cb280-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> <span class="co"># x axis lable</span></span>
<span id="cb280-8"><a href="time-matters.html#cb280-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> <span class="co"># y axis lable</span></span>
<span id="cb280-9"><a href="time-matters.html#cb280-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_continuous</span>(<span class="at">low =</span> <span class="st">&#39;#f7fcfd&#39;</span>,  <span class="co"># set colour for low count</span></span>
<span id="cb280-10"><a href="time-matters.html#cb280-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">high =</span> <span class="st">&#39;#6e016b&#39;</span>) <span class="sc">+</span>   <span class="co"># set colour for high count</span></span>
<span id="cb280-11"><a href="time-matters.html#cb280-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Year, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># separate out by each year</span></span>
<span id="cb280-12"><a href="time-matters.html#cb280-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-185"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-185-1.png" alt="Calendar heat map of aggravated assaults" width="672" />
<p class="caption">
FIGURE 7.1: Calendar heat map of aggravated assaults
</p>
</div>
<p>This sort of visualisation might be useful for example to see if certain days of the week see more incidents than others, possibly due to differences in the underlying routine activities that predominate for example weekends versus weekdays. For a bit of fun, you can read <span class="citation"><a href="#ref-Moss_2013" role="doc-biblioref">Moss</a> (<a href="#ref-Moss_2013" role="doc-biblioref">2013</a>)</span> for a safety rating on each day of the week.</p>
<div id="how-not-to-present-time" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> How (not) to present time</h3>
<p>In our calendar heatmap above we presented count of crimes on each day. But there are other approaches to visualise change over time as well. One such approach is to present <strong>percentage change</strong> from one point in time to the next. There are many issues with this approach, which lead to misinterpreting the data, which are explored in detail by <span class="citation"><a href="#ref-Wheeler_2016" role="doc-biblioref">Wheeler</a> (<a href="#ref-Wheeler_2016" role="doc-biblioref">2016</a>)</span>. For example, he mentions that percent change is not symmetric.</p>
<blockquote>
<p>For example, an increase from 4 to 5 crimes is a 25% increase, whereas a decrease from 5 to 4 crimes is only a 20% decrease. (p.x).</p>
</blockquote>
<p>He presents an alternative metric in Poisson z-scores.</p>
<p>Another issue is with the very popular approach of showing changes as <strong>year-to-date</strong>. In the post “Why you can’t identify changes in crime by comparing this month to last month” <span class="citation"><a href="#ref-Ashby_2020" role="doc-biblioref">Ashby</a> (<a href="#ref-Ashby_2020" role="doc-biblioref">2020</a>)</span> presents some great arguments for why attempts to identify changes in crime frequency that involve simply comparing the number of crimes this week/month/year to the number that occurred last week/month/year, or comparing this week, month etc to the same period last year is not an appropriate way to analyse change over time. For example, doing this means throwing away useful information, ignoring trends and seasonality, and leaves results vulnerable to noise. As an alternative, he promotes the use of creating a forecast based on historic data, and comparing observed values against this.</p>
<p>It is important that when presenting temporal data, we keep in mind these notes of caution, and follow good practice recommendations such as those notes here.</p>
</div>
</div>
<div id="time-series-analysis" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Time series analysis</h2>
<p>A key way to ensure we are analysing our time data appropriately is to deal with time series data, and treat them accordingly. <strong>Time series analysis</strong> looks at trends in crime or incidents. A crime or incident trend is a broad direction or pattern that specific types or general crime and/or incidents are following. Three types of trend can be identified:</p>
<ul>
<li><strong>overall trend</strong> – highlights if the problem is getting worse, better or staying the same over a period of time</li>
<li><strong>seasonal, monthly, weekly or daily cycles of offences</strong> – identified by comparing previous time periods with the same period being analysed</li>
<li><strong>random fluctuations</strong> – caused by a large number of minor influences, or a one-off event, and can include displacement of crime from neighbouring areas due to partnership activity or crime initiatives.</li>
</ul>
<p>Decomposing these trends is an important part of what time series analysis is all about. We will see some examples.</p>
<div id="plotting-time-series-data" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Plotting time series data</h3>
<p>Let’s get some fresh data by travelling about three and a half thousand miles to Spain. The data we will work with now is called <code>femicidos.csv</code> in the companion data (see <em>Preamble</em> to this book if not sure where to find this), and is a collection of intimate partner femicides from Spain.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="time-matters.html#cb281-1" aria-hidden="true" tabindex="-1"></a>femicidos <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/femicidos.csv&quot;</span>)</span></code></pre></div>
<p>This dataframe has only two columns, <code>femicidos</code>, which is a monthly observation of the number of intimate partner femicides per month, starting in January 2003, and <code>month</code>, which is the date for each observation. So, each row represents a monthly count of these crimes.</p>
<p>We could do something like plot the number of crimes over each month using <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="time-matters.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb282-2"><a href="time-matters.html#cb282-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-3"><a href="time-matters.html#cb282-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(femicidos, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> femicidios, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb282-4"><a href="time-matters.html#cb282-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb282-5"><a href="time-matters.html#cb282-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb282-6"><a href="time-matters.html#cb282-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb282-7"><a href="time-matters.html#cb282-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;Number of femicides per month&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;In Spain&quot;</span>) <span class="sc">+</span> </span>
<span id="cb282-8"><a href="time-matters.html#cb282-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">angle =</span> <span class="dv">45</span>))</span></code></pre></div>
<div class="figure"><span id="fig:ggplottime"></span>
<img src="crime_mapping_files/figure-html/ggplottime-1.png" alt="Plot the number of femicides per month" width="672" />
<p class="caption">
FIGURE 7.2: Plot the number of femicides per month
</p>
</div>
<p>This visualisation gives us an insight into how the count of crimes varies between observations, but it subsumes in itself the three elements mentioned above (the overal trend, seasonal fluctuation, and random noise). This makes it difficult to isolate and discuss any one of these, making it difficult to answer the question about whether crime is going up or down, or whether there are any seasonal fluctuations present. In order to achieve this, we want to <strong>decompose</strong> the data into these components.</p>
<p>To look into decomposing into these components, we can use the many functionality within R to deal with time series data. To take advantage of many of these, we will need our dataframe to be stored as a <strong>time series</strong> object. This enables us to apply R’s many functions for analysing time series data. To store the data in a time series object, we use the <code>ts()</code> function. Inside this function, we pass only the column which contains the number of crimes for each month (we filter with the <code>select()</code> function from <code>dplyr</code> package).</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="time-matters.html#cb283-1" aria-hidden="true" tabindex="-1"></a>fem_timeseries <span class="ot">&lt;-</span> <span class="fu">ts</span>(femicidos <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(femicidios))</span></code></pre></div>
<p>We have taken our dataframe of observed values in our time series (monthly observations of crime counts in this case) and transformed it into a matrix with class of “ts” - essentially representing our data as having been sampled at set intervals (in this case every month). Once we have the result stored in our <code>fem_timeseries</code> object, we can auto print to see some details:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="time-matters.html#cb284-1" aria-hidden="true" tabindex="-1"></a>fem_timeseries</span></code></pre></div>
<p>We can see that each observation point has been numbered in order, and we have a value for each observation (the number of femicides recorded in each month). Sometimes the time series data set that you have may have been collected at regular intervals that were less than one year, for example, monthly or quarterly. In this case, you can specify the number of times that data was collected per year by using the <code>frequency</code> parameter in the <code>ts()</code> function. For monthly time series data, you set <code>frequency = 12</code>, while for quarterly time series data, you set <code>frequency = 4</code></p>
<p>You can also specify the first year that the data was collected, and the first interval in that year by using the <code>start</code> parameter in the <code>ts()</code> function. So, in our case, we would do as follows:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="time-matters.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform into time series</span></span>
<span id="cb285-2"><a href="time-matters.html#cb285-2" aria-hidden="true" tabindex="-1"></a>fem_timeseries <span class="ot">&lt;-</span> <span class="fu">ts</span>(femicidos <span class="sc">%&gt;%</span> </span>
<span id="cb285-3"><a href="time-matters.html#cb285-3" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">select</span>(femicidios), <span class="co"># specify dataframe selecting column</span></span>
<span id="cb285-4"><a href="time-matters.html#cb285-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">frequency=</span><span class="dv">12</span>,  <span class="co"># specify monthly frequency</span></span>
<span id="cb285-5"><a href="time-matters.html#cb285-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">start=</span><span class="fu">c</span>(<span class="dv">2003</span>,<span class="dv">1</span>)) <span class="co"># specify start time (January 2003)</span></span></code></pre></div>
<p>Now that we have created this timeseries object, we can use the timeseries specific functions in order to extract meaning and insight. For example, going back to plotting our data so that we can see what sort of trends might be going on with crime, we can make use of the <code>plot.ts()</code> function, the basic plotting method for objects that are of class “ts.”</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="time-matters.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(fem_timeseries)</span></code></pre></div>
<div class="figure">
<img src="crime_mapping_files/figure-html/plot.ts_8a-1.png" alt="Basic plot of our ts object" width="672" />
<p class="caption">
(#fig:plot.ts_8a)Basic plot of our ts object
</p>
</div>
<p>This plot should look similar to the one we created using ggplot2 above, however our observations are now treated as a continuous variable, labeled “Time.” We can of course also use <code>ggplot2</code>to plot a time series like the one we just did but here we would need a variable encoding the date (and preferably a full date, not just month and year as here).</p>
<p>As you can see it is very noisy. Fortunately, the annual count for intimate partner femicides is low in Spain. There seems to be some seasonality too. But what more can we do with plotting time series objects?</p>
<p>A seasonal time series consists of a trend component, a seasonal component and an irregular component. Decomposing the time series means separating the time series into these three components: that is, using statistics to estimate these three components.</p>
<p>To estimate the trend component and seasonal component of a seasonal time series that can be described using an additive model, we can use the <code>decompose()</code> function in R. This function estimates the trend, seasonal, and irregular components of a time series using moving averages. It deals with additive or multiplicative seasonal components (the default is additive).</p>
<p>The function <code>decompose()</code> returns a list object as its result, where the estimates of the seasonal component, trend component and irregular component are stored in named elements of that list objects, called “seasonal,” “trend,” and “random” respectively.</p>
<p>Let’s now decompose this time series to estimate the trend, seasonal and irregular components.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="time-matters.html#cb287-1" aria-hidden="true" tabindex="-1"></a>fem_timeseriescomponents <span class="ot">&lt;-</span> <span class="fu">decompose</span>(fem_timeseries)</span></code></pre></div>
<p>The estimated values of the seasonal, trend and irregular components are now stored in variables <code>fem_timeseriescomponents$seasonal</code>, <code>fem_timeseriescomponents$trend</code> and <code>fem_timeseriescomponents$random</code>. For example, we can print out the estimated values of the seasonal component by typing:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="time-matters.html#cb288-1" aria-hidden="true" tabindex="-1"></a>fem_timeseriescomponents<span class="sc">$</span>seasonal</span></code></pre></div>
<p>The estimated seasonal factors are given for the months January-December, and are the same for each year. The largest seasonal factor is for July (about 0.70), and the lowest is for February (about -0.76), indicating that there seems to be a peak in femicides in July and a trough in femicides in February each year. We can plot the estimated trend, seasonal, and irregular components of the time series by using the <code>plot()</code> function, for example:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="time-matters.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fem_timeseriescomponents)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-187"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-187-1.png" alt="Decomposed time series of femicides in Spain" width="672" />
<p class="caption">
FIGURE 7.3: Decomposed time series of femicides in Spain
</p>
</div>
<p>Once we remove the noise and the seasonal components, it becomes easier to see the estimated trend. Notice that while random and seasonal components still look messy, their scales are different and centred around zero.</p>
<p>We can adapt this code to decompose and estimate the trends for the aggravated assault data for NYC that we used earlier in the chapter too.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="time-matters.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select relevant column (assaults)</span></span>
<span id="cb290-2"><a href="time-matters.html#cb290-2" aria-hidden="true" tabindex="-1"></a>agassault_ny_d2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(agassault_ny_d, assaults)</span>
<span id="cb290-3"><a href="time-matters.html#cb290-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-4"><a href="time-matters.html#cb290-4" aria-hidden="true" tabindex="-1"></a><span class="co">#use ts() to transform to time series object</span></span>
<span id="cb290-5"><a href="time-matters.html#cb290-5" aria-hidden="true" tabindex="-1"></a>ny_timeseries <span class="ot">&lt;-</span> <span class="fu">ts</span>(agassault_ny_d2, <span class="at">frequency=</span><span class="dv">365</span>, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">2014</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb290-6"><a href="time-matters.html#cb290-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-7"><a href="time-matters.html#cb290-7" aria-hidden="true" tabindex="-1"></a><span class="co"># decompose time series</span></span>
<span id="cb290-8"><a href="time-matters.html#cb290-8" aria-hidden="true" tabindex="-1"></a>ny_timeseriescomponents <span class="ot">&lt;-</span> <span class="fu">decompose</span>(ny_timeseries)</span>
<span id="cb290-9"><a href="time-matters.html#cb290-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-10"><a href="time-matters.html#cb290-10" aria-hidden="true" tabindex="-1"></a><span class="co">#plot results</span></span>
<span id="cb290-11"><a href="time-matters.html#cb290-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ny_timeseriescomponents)</span></code></pre></div>
<div class="figure">
<img src="crime_mapping_files/figure-html/decompose_8b-1.png" alt="Decomposed time series of aggravated assaults in NYC" width="672" />
<p class="caption">
(#fig:decompose_8b)Decomposed time series of aggravated assaults in NYC
</p>
</div>
<p>We can also use <code>ggplot2</code> for these purposes. In particular we can use the <code>ggseas</code> extension which allows for seasonal decomposition within <code>ggplot</code> (see <span class="citation"><a href="#ref-Ellis_2018" role="doc-biblioref">Ellis</a> (<a href="#ref-Ellis_2018" role="doc-biblioref">2018</a>)</span> for details). First we can use the <code>tsdf()</code> function from the <code>ggseas</code> package. This turns the <code>ts</code> object we just created into a dataframe and then plot the series.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="time-matters.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggseas)</span>
<span id="cb291-2"><a href="time-matters.html#cb291-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-3"><a href="time-matters.html#cb291-3" aria-hidden="true" tabindex="-1"></a>ny_df <span class="ot">&lt;-</span> <span class="fu">tsdf</span>(ny_timeseries)</span></code></pre></div>
<p>Then we can use the <code>ggsdc()</code> function in order to create a four-facet plot of seasonal decomposition showing observed, trend, seasonal and random components</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="time-matters.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsdc</span>(ny_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y),  <span class="at">method =</span> <span class="st">&quot;decompose&quot;</span>) <span class="sc">+</span></span>
<span id="cb292-2"><a href="time-matters.html#cb292-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_line</span>()</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-188"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-188-1.png" alt="Decomposed time series of aggravated assaults in NYC using ggseas" width="672" />
<p class="caption">
FIGURE 7.4: Decomposed time series of aggravated assaults in NYC using ggseas
</p>
</div>
<p>The resulting graph similarly presents the 4 components, the observe data, the trend, the seasonal component and the random fluctuation.</p>
<p>We have now covered a quick overview of ways of making sense of temporal data. Of course there is a lot more out there, and we urge interested readers to make use of the recommended reading section in this chapter to explore further the topic of temporal data analysis. But now let’s return to the spatial focus of our book.</p>
</div>
</div>
<div id="spatio-temporal-data-visualisation" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Spatio-temporal data visualisation</h2>
<p>For the next set of exercises we are going to look at temporal variations on burglary across Greater Manchester. We are going to focus on wards as the unit of analysis. Accordingly, we will need to import another data set, this time a geojson which contains the wards (administrative boundaries) for Manchester, and the monthly burglary count for each ward in 2018.</p>
<p>To load the ward geometries for Manchester into a <code>sf</code> object we use code we had already used in previous Chapters.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="time-matters.html#cb293-1" aria-hidden="true" tabindex="-1"></a>mcr_burglary <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/mcr_burglary.geojson&quot;</span>)</span></code></pre></div>
<p>With this data in our environment we can plot a map using <code>tmap</code>.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="time-matters.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb294-2"><a href="time-matters.html#cb294-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-3"><a href="time-matters.html#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mcr_burglary) <span class="sc">+</span> </span>
<span id="cb294-4"><a href="time-matters.html#cb294-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">&quot;burglaries&quot;</span>) <span class="sc">+</span></span>
<span id="cb294-5"><a href="time-matters.html#cb294-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() </span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-190"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-190-1.png" alt="Burglaries in Manchester" width="672" />
<p class="caption">
FIGURE 7.5: Burglaries in Manchester
</p>
</div>
<p>So this is something we’re already familiar with. But how can we map the temporal information? We will now cover some approaches.</p>
<div id="small-multiples-to-show-temporal-variation" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Small multiples to show temporal variation</h3>
<p>As noted by <span class="citation"><a href="#ref-Pebesma_2012" role="doc-biblioref">Pebesma</a> (<a href="#ref-Pebesma_2012" role="doc-biblioref">2012</a>)</span>, spatio-temporal data often come in the form of single tables expressed in one of the three following formats:</p>
<ul>
<li><em>time-wide</em> where different columns reflect different moments in time,</li>
<li><em>space-wide</em> where different columns reflect different measurement locations or areas, or</li>
<li><em>long formats</em> where each record reflects a single time and space combination.</li>
</ul>
<p>What we have in the <code>mcr_burglary</code> object if we view the data frame is a table expressed in the long format, where each row represents a single month and ward combination. We can see as well this is not simply a data table but a <code>sf</code> object which embeds the geographical information that allow us to place it in a map. We can now try to produce the small multiples with the <code>tm_facets()</code> function. (Note: if you wanted to use <code>ggplot2</code> instead of <code>tmap</code> you can look up the function <code>facet_wrap()</code> to achieve the same result).</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="time-matters.html#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mcr_burglary) <span class="sc">+</span> </span>
<span id="cb295-2"><a href="time-matters.html#cb295-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">&quot;burglaries&quot;</span>) <span class="sc">+</span></span>
<span id="cb295-3"><a href="time-matters.html#cb295-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb295-4"><a href="time-matters.html#cb295-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="st">&quot;month&quot;</span>, <span class="at">free.coords=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-191"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-191-1.png" alt="Small multiples of burglary across Manchester by month" width="672" />
<p class="caption">
FIGURE 7.6: Small multiples of burglary across Manchester by month
</p>
</div>
<p>So this is one way to visualise temporal variation. What are some more?</p>
</div>
<div id="spaghetti-plots" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> Spaghetti plots</h3>
<p>In longitudinal studies and in studies looking at areas over time, sometimes researchers use spaghetti plots. On their own they are not great, but they can be used when one wants to put a trajectory within a broader context or when comparing different trajectories. You can read more about how to not use them in <span class="citation"><a href="#ref-Nussbaumer_2013" role="doc-biblioref">Nussbaumer</a> (<a href="#ref-Nussbaumer_2013" role="doc-biblioref">2013</a>)</span>.</p>
<p>While we will include the ward name as a spatial component in a way, this isn’t technically spatio-temporal data visualisation, as we are stripping away any sort of spatial element, and keeping ward name only as a nominal variable. It is not great, but let’s show you why you might use it. The basic concept is just the same line chart we saw earlier, but with the trajectories grouped within the wards. So instead of one line, we will get 32: one for each ward in our data.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="time-matters.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mcr_burglary, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> burglaries, <span class="at">group =</span> ward_name)) <span class="sc">+</span> </span>
<span id="cb296-2"><a href="time-matters.html#cb296-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-192"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-192-1.png" alt="Spaghetti plot of burgaries by ward" width="672" />
<p class="caption">
FIGURE 7.7: Spaghetti plot of burgaries by ward
</p>
</div>
<p>This is quite the mess. So in what situation may this be useful? Well maybe you want to compare the variation here with some central tendency. For this we can “grey out” the lines (by changing the colour) and add some summary such as the median let’s say, by using the <code>stat_summary()</code> function.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="time-matters.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mcr_burglary, <span class="fu">aes</span>(<span class="at">x =</span> month,  <span class="at">y =</span> burglaries, <span class="at">group =</span> ward_name)) <span class="sc">+</span> </span>
<span id="cb297-2"><a href="time-matters.html#cb297-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;darkgrey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb297-3"><a href="time-matters.html#cb297-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="co"># we want to summarise all the data together</span></span>
<span id="cb297-4"><a href="time-matters.html#cb297-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,  <span class="co"># geometry to display the summary </span></span>
<span id="cb297-5"><a href="time-matters.html#cb297-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun.y =</span> median, <span class="co"># function to apply</span></span>
<span id="cb297-6"><a href="time-matters.html#cb297-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span>   <span class="co"># specifying thick line for attention</span></span>
<span id="cb297-7"><a href="time-matters.html#cb297-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-193"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-193-1.png" alt="Spaghetti plot of burgaries by ward showing variation around central tendency measure" width="672" />
<p class="caption">
FIGURE 7.8: Spaghetti plot of burgaries by ward showing variation around central tendency measure
</p>
</div>
<p>This way we can show something like the median trajectory compared with the individual observations’ trajectories.</p>
<p>We could also use colour to highlight a specific area compared to the rest of the wards. For example, if we are interested in Fallowfield ward, we might highlight that as an additional layer in our spaghetti pile:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="time-matters.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mcr_burglary, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> burglaries, <span class="at">group =</span> ward_name)) <span class="sc">+</span> </span>
<span id="cb298-2"><a href="time-matters.html#cb298-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;darkgrey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb298-3"><a href="time-matters.html#cb298-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> mcr_burglary <span class="sc">%&gt;%</span>    <span class="co"># pass new data in this layer</span></span>
<span id="cb298-4"><a href="time-matters.html#cb298-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(ward_name <span class="sc">==</span> <span class="st">&quot;Fallowfield&quot;</span>),  <span class="co">#filter only Fallowfield </span></span>
<span id="cb298-5"><a href="time-matters.html#cb298-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> month, </span>
<span id="cb298-6"><a href="time-matters.html#cb298-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> burglaries), </span>
<span id="cb298-7"><a href="time-matters.html#cb298-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>,  <span class="co"># change colour for emphasis</span></span>
<span id="cb298-8"><a href="time-matters.html#cb298-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span> <span class="co"># change line width for emphasis</span></span>
<span id="cb298-9"><a href="time-matters.html#cb298-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-194"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-194-1.png" alt="Spaghetti plot to highlight burglaries in Fallowfield ward" width="672" />
<p class="caption">
FIGURE 7.9: Spaghetti plot to highlight burglaries in Fallowfield ward
</p>
</div>
<p>We can now maybe draw some conclusions about Fallowfield’s burglary trajectory compared with the other wards in our data set. But let’s move on now to the final approach, where we again make use of our spatial component.</p>
</div>
<div id="animations" class="section level3" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> Animations</h3>
<p>The final way we will present here to visualise time and place together is through the use of animations. This feature is brought to <code>ggplot2</code> thanks to the <code>gganimate</code> extension.</p>
<p>The idea behind this display is really similar to that behind the small multiples, introduced earlier. A separate map is created for each month, and these are displayed near one another in order to show the change over time. However, instead of side by side, these maps are sequential - they appear in the same place but one after another, in order to present change.</p>
<p>So first thing we do is to load the <code>gganimate</code> package:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="time-matters.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span></code></pre></div>
<p>Also, to apply <code>gganimate</code> to <code>sf</code> objects, you need to have a package called <code>transformr</code> installed. You don’t need to load this, but make sure it is installed! If not, install with <code>install.packages(transformr)</code>.</p>
<p>Then, we need to make sure that our temporal variable is a date object. We can use the <code>ymd()</code> function, from the fantastic <code>lubridate</code> package (really I cannot praise this package enough, it makes handling dates so easy…!) to make sure that our month variable is a date object.</p>
<p>One thing you might notice looking at this data is that there is no date associated with each observation, only month and year. How can we use <code>ymd()</code> which clearly requires <strong>y</strong>ear <strong>m</strong>onth and <strong>d</strong>ay! Well, one approach is to make this up, and just say that everything in our data happened on the 1st of the month. We can use the <code>paste0()</code> function to do this:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="time-matters.html#cb300-1" aria-hidden="true" tabindex="-1"></a>mcr_burglary<span class="sc">$</span>date_month <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">paste0</span>(mcr_burglary<span class="sc">$</span>month, <span class="st">&quot;-01&quot;</span>))</span></code></pre></div>
<p>Now, we can create a simple static plot, the way we already know how. Let’s plot the number of burglary incidents per ward, and save this in an object called <code>anim</code>:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="time-matters.html#cb301-1" aria-hidden="true" tabindex="-1"></a>anim <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb301-2"><a href="time-matters.html#cb301-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mcr_burglary, <span class="fu">aes</span>(<span class="at">fill =</span> burglaries)) <span class="sc">+</span> </span>
<span id="cb301-3"><a href="time-matters.html#cb301-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p>Now, finally, we can animate this graph. Take the object of the static graph (<code>anim</code>) and add a form of transition, which will be used to animate the graph. In this case, we can use <code>transition_states()</code>. This transition splits your data into multiple states based on the levels in a given column, much like how faceting splits up the data in multiple panels. It then shifts between the defined states and pauses at each state. Layers with data without the specified column will be kept constant during the animation (again, mimicking facet_wrap). States are the unquoted name of the column holding the state levels in the data. You can then use <code>closest_state</code> to dynamically label the graph:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="time-matters.html#cb302-1" aria-hidden="true" tabindex="-1"></a>anim <span class="sc">+</span> </span>
<span id="cb302-2"><a href="time-matters.html#cb302-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(date_month,  <span class="co"># column holding the state levels in the data</span></span>
<span id="cb302-3"><a href="time-matters.html#cb302-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">transition_length =</span> <span class="dv">1</span>, <span class="co"># relative length of the transition</span></span>
<span id="cb302-4"><a href="time-matters.html#cb302-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">state_length =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="co"># elative length of the pause </span></span>
<span id="cb302-5"><a href="time-matters.html#cb302-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Month: {closest_state}&quot;</span>)</span></code></pre></div>
<p>In the print book, you will not see this result, so it’s not very exciting, but hopefully you are following along, and in your own R environment you are now are looking at a very smooth animation of how burglary changed over the months of 2018 in Manchester.</p>
</div>
</div>
<div id="summary-and-further-reading-5" class="section level2" number="7.7">
<h2><span class="header-section-number">7.7</span> Summary and further reading</h2>
<p>In this chapter we had a very brief introduction to temporal data, and considered how we can manipulate and wrangle this new type of data using packages such as <code>lubridate</code>. We then introduced some approaches to visualising temporal data, and finally, ways to visualise spatio-temporal variation as well. To read up on the importance of time, and specifically spatio-temporal crime analysis, we recommend <span class="citation"><a href="#ref-Ratcliffe_2010" role="doc-biblioref">Ratcliffe</a> (<a href="#ref-Ratcliffe_2010" role="doc-biblioref">2010</a>)</span>, <span class="citation"><a href="#ref-Wheeler_2016" role="doc-biblioref">Wheeler</a> (<a href="#ref-Wheeler_2016" role="doc-biblioref">2016</a>)</span>, and <span class="citation"><a href="#ref-Roth_2013" role="doc-biblioref">Roth et al.</a> (<a href="#ref-Roth_2013" role="doc-biblioref">2013</a>)</span>.</p>
<p>While we did not get to go into any spatio-temporal analysis at this stage, visualisation is a good starting point to begin to engage with this important element of crime data. To move into spatio-temporal analysis would require a more thorough training in temporal data analysis first, and so we do not cover here. But we provide some resources for those interested. Notably <span class="citation"><a href="#ref-Hyndman_2021" role="doc-biblioref">Hyndman and Athanasopoulos</a> (<a href="#ref-Hyndman_2021" role="doc-biblioref">2021</a>)</span> is an excellent resource for this, and we can also recommend <span class="citation"><a href="#ref-Chatfield_2019" role="doc-biblioref">Chatfield and Xing</a> (<a href="#ref-Chatfield_2019" role="doc-biblioref">2019</a>)</span>. For those already comfortable with this, <span class="citation"><a href="#ref-Pebesma_2012" role="doc-biblioref">Pebesma</a> (<a href="#ref-Pebesma_2012" role="doc-biblioref">2012</a>)</span> also offers a very thoughtful introduction to how spatio-temporal data layouts appear and useful graphs for spatio-temporal data. <span class="citation"><a href="#ref-Pebesma_2012" role="doc-biblioref">Pebesma</a> (<a href="#ref-Pebesma_2012" role="doc-biblioref">2012</a>)</span> also introduces the R package <code>spacetime</code>, for handling such analyses. At the time of writing, functions in <code>spacetime</code> take as inputs older <code>sp</code> objects, but work on the emerging package <code>sftime</code>, to work with <code>sf</code> objects is ongoing. For additional details in how to visualise space-time data with R we suggest <span class="citation"><a href="#ref-Perpinan_2014" role="doc-biblioref">Lamigueiro</a> (<a href="#ref-Perpinan_2014" role="doc-biblioref">2014</a>)</span> and Chapter 2 of <span class="citation"><a href="#ref-Wikle_2019" role="doc-biblioref">Wikle, Zammit-Mangion, and Cressie</a> (<a href="#ref-Wikle_2019" role="doc-biblioref">2019</a>)</span>.</p>
<p>As noted there are packages that provide functionality for better handling of dates and time. It is worth to go over the details of <code>lubridate</code> in the official page and the relevant chapter in <span class="citation"><a href="#ref-Wickham_2017" role="doc-biblioref">Wickham and Grolemund</a> (<a href="#ref-Wickham_2017" role="doc-biblioref">2017</a>)</span> is also very helpful. There is a brand new package <code>clock</code> that aims to improve on <code>lubridate</code> and that is also worth exploring (for details see <span class="citation"><a href="#ref-Vaughan_2021" role="doc-biblioref">Vaughan</a> (<a href="#ref-Vaughan_2021" role="doc-biblioref">2021</a>)</span>).</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Ashby_2019" class="csl-entry">
———. 2019. <span>“Studying Crime and Place with the Crime Open Database: Social and Behavioural Scienes.”</span> <em>Research Data Journal for the Humanities and Social Sciences</em> 4 (1): 65–80.
</div>
<div id="ref-Ashby_2020" class="csl-entry">
———. 2020. <span>“Why You Can’t Identify Changes in Crime by Comparing This Month to Last Month.”</span> <a href="https://the-sra.org.uk/SRA/Blog/whyyoucantidentifychangesincrimebycomparingthismonthtolastmonth.aspx">https://the-sra.org.uk/SRA/Blog/whyyoucantidentifychangesincrimebycomparingthismonthtolastmonth.aspx</a>.
</div>
<div id="ref-Baumer_1996" class="csl-entry">
Baumer, Eric, and Richard Wright. 1996. <span>“Crime Seasonality and Serious Scholarship: A Comment on Farrell and Pease.”</span> <em>Brit. J. Criminology</em> 36: 579.
</div>
<div id="ref-Chatfield_2019" class="csl-entry">
Chatfield, Chris, and Haipeng Xing. 2019. <em>The Analysis of Time Series: An Introduction with r</em>. 7th ed. Boca Ratón, CA: CRC Press.
</div>
<div id="ref-Ellis_2018" class="csl-entry">
Ellis, Peter. 2018. <em>Ggseas: ’Stats’ for Seasonal Adjustment on the Fly with ’Ggplot2’</em>. <a href="https://CRAN.R-project.org/package=ggseas">https://CRAN.R-project.org/package=ggseas</a>.
</div>
<div id="ref-Herrmann_2013" class="csl-entry">
Herrmann, Christopher R. 2013. <span>“Street-Level Spatiotemporal Crime Analysis: Examples from Bronx County, NY (2006–2010).”</span> In <em>Crime Modeling and Mapping Using Geospatial Technologies</em>, 73–104. Springer.
</div>
<div id="ref-Hyndman_2021" class="csl-entry">
Hyndman, Rob, and George Athanasopoulos. 2021. <em>Forecasting: Principles and Practice</em>. 3rd ed. Melbourne, Australia: OTexts.
</div>
<div id="ref-Perpinan_2014" class="csl-entry">
Lamigueiro, Oscar Perpiñan. 2014. <em>Displaying Time Series, Spatial, and Space-Time Data with r</em>. Boca Raton, CA: CRC Press.
</div>
<div id="ref-Moss_2013" class="csl-entry">
Moss, Stephen. 2013. <span>“Which Is the Most Dangerous Day of the Week?”</span> <a href="https://www.theguardian.com/lifeandstyle/2013/may/29/most-dangerous-day-of-week">https://www.theguardian.com/lifeandstyle/2013/may/29/most-dangerous-day-of-week</a>.
</div>
<div id="ref-Newton_2018" class="csl-entry">
———. 2018. <span>“Macro-Level Generators of Crime, Including Parks, Stadiums, and Transit Stations.”</span> In <em>The Oxford Handbook of Environmental Criminology</em>, edited by Gerben J N Bruinsma and Shane D Johnson, 497–517. Oxford: Oxford University Press.
</div>
<div id="ref-Nussbaumer_2013" class="csl-entry">
Nussbaumer, Cole. 2013. <span>“Strategies for Avoiding the Spaghetti Graph.”</span> <a href="https://www.storytellingwithdata.com/blog/2013/03/avoiding-spaghetti-graph">https://www.storytellingwithdata.com/blog/2013/03/avoiding-spaghetti-graph</a>.
</div>
<div id="ref-Pebesma_2012" class="csl-entry">
Pebesma, Edzer. 2012. <span>“Spacetime: Spatio-Temporal Data in r.”</span> <em>Journal of Statistical Software</em> 51 (7): 1–30.
</div>
<div id="ref-Ratcliffe_2010" class="csl-entry">
———. 2010. <span>“Crime Mapping: Spatial and Temporal Challenges.”</span> In <em>Handbook of Quantitative Criminology</em>, edited by Alex Piquero and David Weisburd, 5–24. New York, NY: Springer.
</div>
<div id="ref-Ratcliffe_1998" class="csl-entry">
Ratcliffe, Jerry H, and Michael J McCullagh. 1998. <span>“Aoristic Crime Analysis.”</span> <em>International Journal of Geographical Information Science</em> 12 (7): 751–64.
</div>
<div id="ref-Roth_2013" class="csl-entry">
Roth, Robert E, Kevin S Ross, Benjamin G Finch, Wei Luo, and Alan M MacEachren. 2013. <span>“Spatiotemporal Crime Analysis in US Law Enforcement Agencies: Current Practices and Unmet Needs.”</span> <em>Government Information Quarterly</em> 30 (3): 226–40.
</div>
<div id="ref-Tompson_2013" class="csl-entry">
Tompson, Lisa, and Kate Bowers. 2013. <span>“A Stab in the Dark? A Research Note on Temporal Patterns of Street Robbery.”</span> <em>Journal of Research in Crime and Delinquency</em> 50 (4): 616–31.
</div>
<div id="ref-Vaughan_2021" class="csl-entry">
Vaughan, Davis. 2021. <span>“Comprehensive Date-Time Handling for r.”</span> <a href="https://www.tidyverse.org/blog/2021/03/clock-0-1-0/">https://www.tidyverse.org/blog/2021/03/clock-0-1-0/</a>.
</div>
<div id="ref-Wheeler_2016" class="csl-entry">
Wheeler, Andrew P. 2016. <span>“Tables and Graphs for Monitoring Temporal Crime Trends: Translating Theory into Practical Crime Analysis Advice.”</span> <em>International Journal of Police Science &amp; Management</em> 18 (3): 159–72.
</div>
<div id="ref-Wickham_2017" class="csl-entry">
Wickham, Hadley, and Garrett Grolemund. 2017. <em>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</em>. Boston, MA: O´Reilly.
</div>
<div id="ref-Wikle_2019" class="csl-entry">
Wikle, Christopher, Andrew Zammit-Mangion, and Noel Cressie. 2019. <em>Spatio-Temporal Statistics with r</em>. Boca Raton, CA: CRC Press.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="visualisation-good-cartographic-design.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-7-spatial-point-patterns-of-crime-events.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/06-time_matters.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["crime_mapping.pdf", "crime_mapping.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
