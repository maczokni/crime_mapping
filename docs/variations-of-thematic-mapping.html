<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Variations of thematic mapping | Crime Mapping and Spatial Data Analysis using R</title>
  <meta name="description" content="Chapter 5 Variations of thematic mapping | Crime Mapping and Spatial Data Analysis using R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Variations of thematic mapping | Crime Mapping and Spatial Data Analysis using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 5 Variations of thematic mapping | Crime Mapping and Spatial Data Analysis using R" />
  <meta name="github-repo" content="maczokni/crime_mapping" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Variations of thematic mapping | Crime Mapping and Spatial Data Analysis using R" />
  
  <meta name="twitter:description" content="Chapter 5 Variations of thematic mapping | Crime Mapping and Spatial Data Analysis using R" />
  

<meta name="author" content="Juanjo Medina and Reka Solymosi" />


<meta name="date" content="2022-01-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mapping-rates-and-counts.html"/>
<link rel="next" href="basics-of-cartographic-design-elements-of-a-map.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<link href="libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet/leaflet.js"></script>
<link href="libs/leafletfix/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4/proj4.min.js"></script>
<script src="libs/Proj4Leaflet/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding/leaflet.js"></script>
<script src="libs/leaflet-providers/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin/leaflet-providers-plugin.js"></script>
<script src="libs/burglary_raster_cc_9107d3/data_stars_burglary_raster_cc983ce5.txt"></script>
<script src="libs/joda/joda.js"></script>
<script src="libs/joda/addImageQuery-bindings.js"></script>
<script src="libs/clipboard/setClipboardText.js"></script>
<link href="libs/HomeButton/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton/home-button.js"></script>
<script src="libs/HomeButton/easy-button-src.min.js"></script>
<link href="libs/mapviewCSS/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS/mapview.css" rel="stylesheet" />
<script src="libs/Leaflet.Sync/L.Map.Sync.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Crime Mapping and Spatial Data Analysis using R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble: how to use this book</a></li>
<li class="chapter" data-level="2" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html"><i class="fa fa-check"></i><b>2</b> Producing your first crime map</a>
<ul>
<li class="chapter" data-level="2.1" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#geospatial-perspective-key-terms-and-ideas"><i class="fa fa-check"></i><b>2.2</b> Geospatial Perspective: key terms and ideas</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#place"><i class="fa fa-check"></i><b>2.2.1</b> Place</a></li>
<li class="chapter" data-level="2.2.2" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#attributes"><i class="fa fa-check"></i><b>2.2.2</b> Attributes</a></li>
<li class="chapter" data-level="2.2.3" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#spatial-objects"><i class="fa fa-check"></i><b>2.2.3</b> Spatial objects</a></li>
<li class="chapter" data-level="2.2.4" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#networks"><i class="fa fa-check"></i><b>2.2.4</b> Networks</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#maps-and-their-types"><i class="fa fa-check"></i><b>2.3</b> Maps and their types</a></li>
<li class="chapter" data-level="2.4" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#map-projections-and-geographic-coordinate-systems"><i class="fa fa-check"></i><b>2.4</b> Map projections and geographic coordinate systems</a></li>
<li class="chapter" data-level="2.5" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#key-terms-summary"><i class="fa fa-check"></i><b>2.5</b> Key terms summary</a></li>
<li class="chapter" data-level="2.6" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#getting-started-with-crime-data"><i class="fa fa-check"></i><b>2.6</b> Getting started with crime data</a></li>
<li class="chapter" data-level="2.7" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#from-dataframes-to-spatial-objects"><i class="fa fa-check"></i><b>2.7</b> From dataframes to spatial objects</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#the-point"><i class="fa fa-check"></i><b>2.7.1</b> The point</a></li>
<li class="chapter" data-level="2.7.2" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#the-line"><i class="fa fa-check"></i><b>2.7.2</b> The line</a></li>
<li class="chapter" data-level="2.7.3" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#the-polygon"><i class="fa fa-check"></i><b>2.7.3</b> The polygon</a></li>
<li class="chapter" data-level="2.7.4" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#choosing-the-ideal-unit-of-analysis"><i class="fa fa-check"></i><b>2.7.4</b> Choosing the ideal unit of analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#the-simple-features-framework"><i class="fa fa-check"></i><b>2.8</b> The simple features framework</a></li>
<li class="chapter" data-level="2.9" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#plotting-data-with-ggplot2"><i class="fa fa-check"></i><b>2.9</b> Plotting data with ggplot2</a></li>
<li class="chapter" data-level="2.10" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#mapping-crime-data-as-points"><i class="fa fa-check"></i><b>2.10</b> Mapping crime data as points</a></li>
<li class="chapter" data-level="2.11" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#mapping-crime-data-as-polygons"><i class="fa fa-check"></i><b>2.11</b> Mapping crime data as polygons</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#finding-boundary-data"><i class="fa fa-check"></i><b>2.11.1</b> Finding boundary data</a></li>
<li class="chapter" data-level="2.11.2" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#reading-shapefiles-into-r"><i class="fa fa-check"></i><b>2.11.2</b> Reading shapefiles into R</a></li>
<li class="chapter" data-level="2.11.3" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#data-wrangling-with-dplyr"><i class="fa fa-check"></i><b>2.11.3</b> Data wrangling with dplyr</a></li>
<li class="chapter" data-level="2.11.4" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#join-data-to-sf-object"><i class="fa fa-check"></i><b>2.11.4</b> Join data to sf object</a></li>
<li class="chapter" data-level="2.11.5" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#putting-polygon-data-on-the-map"><i class="fa fa-check"></i><b>2.11.5</b> Putting polygon data on the map</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="producing-your-first-crime-map.html"><a href="producing-your-first-crime-map.html#summary-and-further-reading"><i class="fa fa-check"></i><b>2.12</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html"><i class="fa fa-check"></i><b>3</b> Basic geospatial operations in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#exploring-the-relationship-between-alcohol-outlets-and-crime"><i class="fa fa-check"></i><b>3.2</b> Exploring the relationship between alcohol outlets and crime</a></li>
<li class="chapter" data-level="3.3" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#acquiring-relevant-data"><i class="fa fa-check"></i><b>3.3</b> Acquiring relevant data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#reading-in-crime-data"><i class="fa fa-check"></i><b>3.3.1</b> Reading in crime data</a></li>
<li class="chapter" data-level="3.3.2" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#meet-a-new-format-geojson"><i class="fa fa-check"></i><b>3.3.2</b> Meet a new format: geoJSON</a></li>
<li class="chapter" data-level="3.3.3" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#open-street-map-and-points-of-interest"><i class="fa fa-check"></i><b>3.3.3</b> Open Street Map and points of interest</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#attribute-operations"><i class="fa fa-check"></i><b>3.4</b> Attribute operations</a></li>
<li class="chapter" data-level="3.5" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#spatial-operations"><i class="fa fa-check"></i><b>3.5</b> Spatial operations</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#reprojecting-coordinates"><i class="fa fa-check"></i><b>3.5.1</b> Reprojecting coordinates</a></li>
<li class="chapter" data-level="3.5.2" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#subsetting-points"><i class="fa fa-check"></i><b>3.5.2</b> Subsetting points</a></li>
<li class="chapter" data-level="3.5.3" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#building-buffers"><i class="fa fa-check"></i><b>3.5.3</b> Building buffers</a></li>
<li class="chapter" data-level="3.5.4" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#counting-points-within-a-polygon"><i class="fa fa-check"></i><b>3.5.4</b> Counting Points within a Polygon</a></li>
<li class="chapter" data-level="3.5.5" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#distances-finding-the-nearest-point"><i class="fa fa-check"></i><b>3.5.5</b> Distances: Finding the nearest point</a></li>
<li class="chapter" data-level="3.5.6" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#measuring-distances"><i class="fa fa-check"></i><b>3.5.6</b> Measuring distances</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#plotting-interactive-maps-with-leaflet"><i class="fa fa-check"></i><b>3.6</b> Plotting interactive maps with leaflet</a></li>
<li class="chapter" data-level="3.7" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#geocoding"><i class="fa fa-check"></i><b>3.7</b> Geocoding</a></li>
<li class="chapter" data-level="3.8" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#measuring-distance-more-thoroughly"><i class="fa fa-check"></i><b>3.8</b> Measuring distance more thoroughly</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#how-far-are-police-stations-in-madrid"><i class="fa fa-check"></i><b>3.8.1</b> How far are police stations in Madrid?</a></li>
<li class="chapter" data-level="3.8.2" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#distance-in-geographical-space"><i class="fa fa-check"></i><b>3.8.2</b> Distance in geographical space</a></li>
<li class="chapter" data-level="3.8.3" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#a-practical-example-to-evaluate-distance"><i class="fa fa-check"></i><b>3.8.3</b> A practical example to evaluate distance</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="basic-geospatial-operations-in-r.html"><a href="basic-geospatial-operations-in-r.html#summary-and-further-reading-1"><i class="fa fa-check"></i><b>3.9</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html"><i class="fa fa-check"></i><b>4</b> Mapping rates and counts</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#thematic-maps-key-terms-and-ideas"><i class="fa fa-check"></i><b>4.2</b> Thematic maps: key terms and ideas</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#choropleth-maps"><i class="fa fa-check"></i><b>4.2.1</b> Choropleth maps</a></li>
<li class="chapter" data-level="4.2.2" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#what-do-we-use-choropleth-maps-for"><i class="fa fa-check"></i><b>4.2.2</b> What do we use choropleth maps for?</a></li>
<li class="chapter" data-level="4.2.3" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#proportional-and-graduate-symbol-maps-mapping-crime-counts"><i class="fa fa-check"></i><b>4.2.3</b> Proportional and graduate symbol maps: mapping crime counts</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#creating-proportional-symbol-maps"><i class="fa fa-check"></i><b>4.3</b> Creating proportional symbol maps</a></li>
<li class="chapter" data-level="4.4" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#mapping-rates-rather-than-counts"><i class="fa fa-check"></i><b>4.4</b> Mapping rates rather than counts</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#generating-the-rates"><i class="fa fa-check"></i><b>4.4.1</b> Generating the rates</a></li>
<li class="chapter" data-level="4.4.2" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#creating-a-choropleth-map-with-tmap"><i class="fa fa-check"></i><b>4.4.2</b> Creating a choropleth map with tmap</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#classification-systems-for-thematic-maps"><i class="fa fa-check"></i><b>4.5</b> Classification systems for thematic maps</a></li>
<li class="chapter" data-level="4.6" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#interactive-mapping-with-tmap"><i class="fa fa-check"></i><b>4.6</b> Interactive mapping with tmap</a></li>
<li class="chapter" data-level="4.7" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#smoothing-rates-adjusting-for-small-sample-noise"><i class="fa fa-check"></i><b>4.7</b> Smoothing rates: adjusting for small sample noise</a></li>
<li class="chapter" data-level="4.8" data-path="mapping-rates-and-counts.html"><a href="mapping-rates-and-counts.html#summary-and-further-reading-2"><i class="fa fa-check"></i><b>4.8</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html"><i class="fa fa-check"></i><b>5</b> Variations of thematic mapping</a>
<ul>
<li class="chapter" data-level="5.1" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#binning-points"><i class="fa fa-check"></i><b>5.2</b> Binning points</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#the-binning-process"><i class="fa fa-check"></i><b>5.2.1</b> The Binning Process</a></li>
<li class="chapter" data-level="5.2.2" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#different-binning-techniques"><i class="fa fa-check"></i><b>5.2.2</b> Different Binning Techniques</a></li>
<li class="chapter" data-level="5.2.3" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#benefits-of-binning"><i class="fa fa-check"></i><b>5.2.3</b> Benefits of Binning</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#transforming-polygons-cartograms"><i class="fa fa-check"></i><b>5.3</b> Transforming polygons: cartograms</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#dorling-cartogram"><i class="fa fa-check"></i><b>5.3.1</b> Dorling Cartogram</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#bivariate-maps"><i class="fa fa-check"></i><b>5.4</b> Bivariate Maps</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#step-1-bin-our-variables-of-interest"><i class="fa fa-check"></i><b>5.4.1</b> Step 1: Bin our variables of interest</a></li>
<li class="chapter" data-level="5.4.2" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#step-2-new-variable"><i class="fa fa-check"></i><b>5.4.2</b> Step 2: New variable</a></li>
<li class="chapter" data-level="5.4.3" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#step-3-create-colour-scheme"><i class="fa fa-check"></i><b>5.4.3</b> Step 3: Create colour scheme</a></li>
<li class="chapter" data-level="5.4.4" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#step-4-join-colour-scheme"><i class="fa fa-check"></i><b>5.4.4</b> Step 4: Join colour scheme</a></li>
<li class="chapter" data-level="5.4.5" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#step-5-create-legend"><i class="fa fa-check"></i><b>5.4.5</b> Step 5: Create legend</a></li>
<li class="chapter" data-level="5.4.6" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#step-6-map"><i class="fa fa-check"></i><b>5.4.6</b> Step 6: Map</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#a-note-of-caution-maup"><i class="fa fa-check"></i><b>5.5</b> A note of caution: MAUP</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#why-does-maup-matter"><i class="fa fa-check"></i><b>5.5.1</b> Why does MAUP matter?</a></li>
<li class="chapter" data-level="5.5.2" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#what-can-we-do"><i class="fa fa-check"></i><b>5.5.2</b> What can we do?</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="variations-of-thematic-mapping.html"><a href="variations-of-thematic-mapping.html#summary-and-further-reading-3"><i class="fa fa-check"></i><b>5.6</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html"><i class="fa fa-check"></i><b>6</b> Basics of cartographic design: elements of a map</a>
<ul>
<li class="chapter" data-level="6.1" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#data-representation"><i class="fa fa-check"></i><b>6.2</b> Data representation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#thematic-maps"><i class="fa fa-check"></i><b>6.2.1</b> Thematic maps</a></li>
<li class="chapter" data-level="6.2.2" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#symbols"><i class="fa fa-check"></i><b>6.2.2</b> Symbols</a></li>
<li class="chapter" data-level="6.2.3" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#rate-vs-count"><i class="fa fa-check"></i><b>6.2.3</b> Rate vs count</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#colour"><i class="fa fa-check"></i><b>6.3</b> Colour</a></li>
<li class="chapter" data-level="6.4" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#text"><i class="fa fa-check"></i><b>6.4</b> Text</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#titles-and-subtitles"><i class="fa fa-check"></i><b>6.4.1</b> Titles and subtitles</a></li>
<li class="chapter" data-level="6.4.2" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#legend"><i class="fa fa-check"></i><b>6.4.2</b> Legend</a></li>
<li class="chapter" data-level="6.4.3" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#annotation"><i class="fa fa-check"></i><b>6.4.3</b> Annotation</a></li>
<li class="chapter" data-level="6.4.4" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#production-notes"><i class="fa fa-check"></i><b>6.4.4</b> Production notes</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#composition"><i class="fa fa-check"></i><b>6.5</b> Composition</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#orientation-indicators"><i class="fa fa-check"></i><b>6.5.1</b> Orientation indicators</a></li>
<li class="chapter" data-level="6.5.2" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#scale-indicators"><i class="fa fa-check"></i><b>6.5.2</b> Scale indicators</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#context"><i class="fa fa-check"></i><b>6.6</b> Context</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#basemap"><i class="fa fa-check"></i><b>6.6.1</b> Basemap</a></li>
<li class="chapter" data-level="6.6.2" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#inset-maps"><i class="fa fa-check"></i><b>6.6.2</b> Inset maps</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="basics-of-cartographic-design-elements-of-a-map.html"><a href="basics-of-cartographic-design-elements-of-a-map.html#summary-and-further-reading-4"><i class="fa fa-check"></i><b>6.7</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-matters.html"><a href="time-matters.html"><i class="fa fa-check"></i><b>7</b> Time matters</a>
<ul>
<li class="chapter" data-level="7.1" data-path="time-matters.html"><a href="time-matters.html#introduction-5"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="time-matters.html"><a href="time-matters.html#temporal-data-in-crime-analysis"><i class="fa fa-check"></i><b>7.2</b> Temporal data in crime analysis</a></li>
<li class="chapter" data-level="7.3" data-path="time-matters.html"><a href="time-matters.html#temporal-data-wrangling"><i class="fa fa-check"></i><b>7.3</b> Temporal data wrangling</a></li>
<li class="chapter" data-level="7.4" data-path="time-matters.html"><a href="time-matters.html#visualising-time-data"><i class="fa fa-check"></i><b>7.4</b> Visualising time data</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="time-matters.html"><a href="time-matters.html#how-not-to-present-time"><i class="fa fa-check"></i><b>7.4.1</b> How (not) to present time</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="time-matters.html"><a href="time-matters.html#time-series-analysis"><i class="fa fa-check"></i><b>7.5</b> Time series analysis</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="time-matters.html"><a href="time-matters.html#plotting-time-series-data"><i class="fa fa-check"></i><b>7.5.1</b> Plotting time series data</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="time-matters.html"><a href="time-matters.html#spatio-temporal-data-visualisation"><i class="fa fa-check"></i><b>7.6</b> Spatio-temporal data visualisation</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="time-matters.html"><a href="time-matters.html#small-multiples-to-show-temporal-variation"><i class="fa fa-check"></i><b>7.6.1</b> Small multiples to show temporal variation</a></li>
<li class="chapter" data-level="7.6.2" data-path="time-matters.html"><a href="time-matters.html#spaghetti-plots"><i class="fa fa-check"></i><b>7.6.2</b> Spaghetti plots</a></li>
<li class="chapter" data-level="7.6.3" data-path="time-matters.html"><a href="time-matters.html#animations"><i class="fa fa-check"></i><b>7.6.3</b> Animations</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="time-matters.html"><a href="time-matters.html#summary-and-further-reading-5"><i class="fa fa-check"></i><b>7.7</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html"><i class="fa fa-check"></i><b>8</b> Spatial point patterns of crime events</a>
<ul>
<li class="chapter" data-level="8.1" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html#mapping-crime-intensity-with-isarithmic-maps"><i class="fa fa-check"></i><b>8.1</b> Mapping crime intensity with isarithmic maps</a></li>
<li class="chapter" data-level="8.2" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html#burglaries-in-nyc"><i class="fa fa-check"></i><b>8.2</b> Burglaries in NYC</a></li>
<li class="chapter" data-level="8.3" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html#using-the-spatstat-package"><i class="fa fa-check"></i><b>8.3</b> Using the <code>spatstat</code> package</a></li>
<li class="chapter" data-level="8.4" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html#homogeneous-or-spatially-varying-intensity"><i class="fa fa-check"></i><b>8.4</b> Homogeneous or spatially varying intensity?</a></li>
<li class="chapter" data-level="8.5" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html#mapping-intensity-estimates-with-spatstat"><i class="fa fa-check"></i><b>8.5</b> Mapping intensity estimates with <code>spatstat</code></a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html#basics-of-kernel-density-estimation-kde"><i class="fa fa-check"></i><b>8.5.1</b> Basics of kernel density estimation (KDE)</a></li>
<li class="chapter" data-level="8.5.2" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html#selecting-the-appropriate-bandwith-for-kde"><i class="fa fa-check"></i><b>8.5.2</b> Selecting the appropriate bandwith for KDE</a></li>
<li class="chapter" data-level="8.5.3" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html#selecting-the-smoothing-kernel"><i class="fa fa-check"></i><b>8.5.3</b> Selecting the smoothing kernel</a></li>
<li class="chapter" data-level="8.5.4" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html#weighted-kernel-density-estimates"><i class="fa fa-check"></i><b>8.5.4</b> Weighted kernel density estimates</a></li>
<li class="chapter" data-level="8.5.5" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html#better-kde-maps-using-leaflet"><i class="fa fa-check"></i><b>8.5.5</b> Better KDE maps using <code>leaflet</code></a></li>
<li class="chapter" data-level="8.5.6" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html#problems-with-kde"><i class="fa fa-check"></i><b>8.5.6</b> Problems with KDE</a></li>
<li class="chapter" data-level="8.5.7" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html#other-packages-for-kde"><i class="fa fa-check"></i><b>8.5.7</b> Other packages for KDE</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="spatial-point-patterns-of-crime-events.html"><a href="spatial-point-patterns-of-crime-events.html#summary-and-further-reading-6"><i class="fa fa-check"></i><b>8.6</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html"><i class="fa fa-check"></i><b>9</b> Crime along spatial networks</a>
<ul>
<li class="chapter" data-level="9.1" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#introduction-6"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#constructing-and-storing-a-spatial-linear-network"><i class="fa fa-check"></i><b>9.2</b> Constructing and storing a spatial linear network</a></li>
<li class="chapter" data-level="9.3" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#visualising-crime-distribution-along-networks"><i class="fa fa-check"></i><b>9.3</b> Visualising crime distribution along networks</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#selecting-relevant-crimes-for-micro-places"><i class="fa fa-check"></i><b>9.3.1</b> Selecting relevant crimes for micro-places</a></li>
<li class="chapter" data-level="9.3.2" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#assigning-joining-crimes-to-micro-places"><i class="fa fa-check"></i><b>9.3.2</b> Assigning (joining) crimes to micro-places</a></li>
<li class="chapter" data-level="9.3.3" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#calculating-a-crime-rate"><i class="fa fa-check"></i><b>9.3.3</b> Calculating a crime rate</a></li>
<li class="chapter" data-level="9.3.4" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#hot-routes"><i class="fa fa-check"></i><b>9.3.4</b> Hot Routes</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#quantifying-crime-concentration-at-micro-places"><i class="fa fa-check"></i><b>9.4</b> Quantifying crime concentration at micro-places</a></li>
<li class="chapter" data-level="9.5" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#street-profile-analysis"><i class="fa fa-check"></i><b>9.5</b> Street Profile Analysis</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#linking-data-to-nodes"><i class="fa fa-check"></i><b>9.5.1</b> Linking data to nodes</a></li>
<li class="chapter" data-level="9.5.2" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#calculating-a-rate-for-nodes"><i class="fa fa-check"></i><b>9.5.2</b> Calculating a rate for nodes</a></li>
<li class="chapter" data-level="9.5.3" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#visualising-with-street-profile-analysis"><i class="fa fa-check"></i><b>9.5.3</b> Visualising with Street Profile Analysis</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#density-estimation-along-networks"><i class="fa fa-check"></i><b>9.6</b> Density estimation along networks</a></li>
<li class="chapter" data-level="9.7" data-path="crime-along-spatial-networks.html"><a href="crime-along-spatial-networks.html#summary-and-further-reading-7"><i class="fa fa-check"></i><b>9.7</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html"><i class="fa fa-check"></i><b>10</b> Spatial dependence and autocorrelation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#introduction-7"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#exploring-spatial-dependence-in-point-pattern-data"><i class="fa fa-check"></i><b>10.2</b> Exploring spatial dependence in point pattern data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#the-empirical-k-function"><i class="fa fa-check"></i><b>10.2.1</b> The empirical K function</a></li>
<li class="chapter" data-level="10.2.2" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#homicide-in-buenos-aires"><i class="fa fa-check"></i><b>10.2.2</b> Homicide in Buenos Aires</a></li>
<li class="chapter" data-level="10.2.3" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#estimating-and-plotting-the-k-function"><i class="fa fa-check"></i><b>10.2.3</b> Estimating and plotting the K-function</a></li>
<li class="chapter" data-level="10.2.4" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#network-constrained-k-function"><i class="fa fa-check"></i><b>10.2.4</b> Network constrained K function</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#exploring-spatial-autocorrelation-in-lattice-data"><i class="fa fa-check"></i><b>10.3</b> Exploring spatial autocorrelation in lattice data</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#burglary-in-manchester"><i class="fa fa-check"></i><b>10.3.1</b> Burglary in Manchester</a></li>
<li class="chapter" data-level="10.3.2" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#what-is-a-neighbour"><i class="fa fa-check"></i><b>10.3.2</b> What is a neighbour?</a></li>
<li class="chapter" data-level="10.3.3" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#creating-a-list-of-neighbours-based-on-contiguity"><i class="fa fa-check"></i><b>10.3.3</b> Creating a list of neighbours based on contiguity</a></li>
<li class="chapter" data-level="10.3.4" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#generating-the-weight-matrix"><i class="fa fa-check"></i><b>10.3.4</b> Generating the weight matrix</a></li>
<li class="chapter" data-level="10.3.5" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#spatial-weight-matrix-based-on-distance"><i class="fa fa-check"></i><b>10.3.5</b> Spatial weight matrix based on distance</a></li>
<li class="chapter" data-level="10.3.6" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#spatial-weight-matrix-based-on-k-neighbors"><i class="fa fa-check"></i><b>10.3.6</b> Spatial weight matrix based on k-neighbors</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#choosing-the-correct-matrix"><i class="fa fa-check"></i><b>10.4</b> Choosing the correct matrix</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#measuring-global-autocorrelation"><i class="fa fa-check"></i><b>10.4.1</b> Measuring global autocorrelation</a></li>
<li class="chapter" data-level="10.4.2" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#the-rgeoda-and-sfweight-packages"><i class="fa fa-check"></i><b>10.4.2</b> The <code>rgeoda</code> and <code>sfweight</code> packages</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="spatial-dependence-and-autocorrelation.html"><a href="spatial-dependence-and-autocorrelation.html#further-reading"><i class="fa fa-check"></i><b>10.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html"><i class="fa fa-check"></i><b>11</b> Detecting hot spots and repeats</a>
<ul>
<li class="chapter" data-level="11.1" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#introduction-8"><i class="fa fa-check"></i><b>11.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#clusters-hot-spots-of-crime-and-near-repeat-victimisation"><i class="fa fa-check"></i><b>11.1.1</b> Clusters, hot spots of crime, and near repeat victimisation</a></li>
<li class="chapter" data-level="11.1.2" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#burglaries-in-manchester"><i class="fa fa-check"></i><b>11.1.2</b> Burglaries in Manchester</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#using-raster-micro-grid-cells-to-spot-hot-spots"><i class="fa fa-check"></i><b>11.2</b> Using <code>raster</code> micro grid cells to spot hot spots</a></li>
<li class="chapter" data-level="11.3" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#local-getis-ord"><i class="fa fa-check"></i><b>11.3</b> Local Getis-Ord</a></li>
<li class="chapter" data-level="11.4" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#local-morans-i-and-moran-scaterplot"><i class="fa fa-check"></i><b>11.4</b> Local Moran’s I and Moran scaterplot</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#computing-the-local-morans-i"><i class="fa fa-check"></i><b>11.4.1</b> Computing the local Moran’s I</a></li>
<li class="chapter" data-level="11.4.2" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#creating-a-lisa-map"><i class="fa fa-check"></i><b>11.4.2</b> Creating a LISA map</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#scan-satistics"><i class="fa fa-check"></i><b>11.5</b> Scan satistics</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#the-dcluster-package"><i class="fa fa-check"></i><b>11.5.1</b> The <code>DCluster</code> package</a></li>
<li class="chapter" data-level="11.5.2" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#openshaws-gam"><i class="fa fa-check"></i><b>11.5.2</b> Openshaw’s GAM</a></li>
<li class="chapter" data-level="11.5.3" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#kulldorfs-scan-statistic"><i class="fa fa-check"></i><b>11.5.3</b> Kulldorf’s Scan Statistic</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#exploring-near-repeat-victimisation"><i class="fa fa-check"></i><b>11.6</b> Exploring near repeat victimisation</a></li>
<li class="chapter" data-level="11.7" data-path="detecting-hot-spots-and-repeats.html"><a href="detecting-hot-spots-and-repeats.html#further-reading-1"><i class="fa fa-check"></i><b>11.7</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="spatial-regression-models.html"><a href="spatial-regression-models.html"><i class="fa fa-check"></i><b>12</b> Spatial regression models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="spatial-regression-models.html"><a href="spatial-regression-models.html#introduction-9"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="spatial-regression-models.html"><a href="spatial-regression-models.html#challenges-for-regression-with-spatial-data"><i class="fa fa-check"></i><b>12.2</b> Challenges for regression with spatial data</a></li>
<li class="chapter" data-level="12.3" data-path="spatial-regression-models.html"><a href="spatial-regression-models.html#fitting-a-non-spatial-regression-model-with-r"><i class="fa fa-check"></i><b>12.3</b> Fitting a non-spatial regression model with R</a></li>
<li class="chapter" data-level="12.4" data-path="spatial-regression-models.html"><a href="spatial-regression-models.html#looking-at-the-residuals-and-testing-for-spatial-autocorrelation-in-regression"><i class="fa fa-check"></i><b>12.4</b> Looking at the residuals and testing for spatial autocorrelation in regression</a></li>
<li class="chapter" data-level="12.5" data-path="spatial-regression-models.html"><a href="spatial-regression-models.html#choosing-a-spatial-regression-model"><i class="fa fa-check"></i><b>12.5</b> Choosing a spatial regression model</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="spatial-regression-models.html"><a href="spatial-regression-models.html#the-basic-spatial-models"><i class="fa fa-check"></i><b>12.5.1</b> The basic spatial models</a></li>
<li class="chapter" data-level="12.5.2" data-path="spatial-regression-models.html"><a href="spatial-regression-models.html#lagrange-multipliers-the-bottom-up-approach-to-select-a-model"><i class="fa fa-check"></i><b>12.5.2</b> Lagrange multipliers: the bottom-up approach to select a model</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="spatial-regression-models.html"><a href="spatial-regression-models.html#fitting-and-interpreting-a-spatial-error-model"><i class="fa fa-check"></i><b>12.6</b> Fitting and interpreting a spatial error model</a></li>
<li class="chapter" data-level="12.7" data-path="spatial-regression-models.html"><a href="spatial-regression-models.html#fitting-and-interpreting-a-spatially-lagged-model"><i class="fa fa-check"></i><b>12.7</b> Fitting and interpreting a spatially lagged model</a></li>
<li class="chapter" data-level="12.8" data-path="spatial-regression-models.html"><a href="spatial-regression-models.html#beyond-the-sar-and-sem-models"><i class="fa fa-check"></i><b>12.8</b> Beyond the SAR and SEM models</a></li>
<li class="chapter" data-level="12.9" data-path="spatial-regression-models.html"><a href="spatial-regression-models.html#summary-and-further-reading-8"><i class="fa fa-check"></i><b>12.9</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="spatial-heterogeneity-and-regression.html"><a href="spatial-heterogeneity-and-regression.html"><i class="fa fa-check"></i><b>13</b> Spatial heterogeneity and regression</a>
<ul>
<li class="chapter" data-level="13.1" data-path="spatial-heterogeneity-and-regression.html"><a href="spatial-heterogeneity-and-regression.html#introduction-10"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="spatial-heterogeneity-and-regression.html"><a href="spatial-heterogeneity-and-regression.html#spatial-regimes"><i class="fa fa-check"></i><b>13.2</b> Spatial regimes</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="spatial-heterogeneity-and-regression.html"><a href="spatial-heterogeneity-and-regression.html#fitting-the-constrained-and-the-unconstrained-models"><i class="fa fa-check"></i><b>13.2.1</b> Fitting the constrained and the unconstrained models</a></li>
<li class="chapter" data-level="13.2.2" data-path="spatial-heterogeneity-and-regression.html"><a href="spatial-heterogeneity-and-regression.html#running-the-chow-test"><i class="fa fa-check"></i><b>13.2.2</b> Running the Chow test</a></li>
<li class="chapter" data-level="13.2.3" data-path="spatial-heterogeneity-and-regression.html"><a href="spatial-heterogeneity-and-regression.html#spatial-dependence-with-spatial-heterogeneity"><i class="fa fa-check"></i><b>13.2.3</b> Spatial dependence with spatial heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="spatial-heterogeneity-and-regression.html"><a href="spatial-heterogeneity-and-regression.html#geographically-weighted-regression"><i class="fa fa-check"></i><b>13.3</b> Geographically Weighted Regression</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="spatial-heterogeneity-and-regression.html"><a href="spatial-heterogeneity-and-regression.html#calculate-kernel-bandwidth"><i class="fa fa-check"></i><b>13.3.1</b> Calculate kernel bandwidth</a></li>
<li class="chapter" data-level="13.3.2" data-path="spatial-heterogeneity-and-regression.html"><a href="spatial-heterogeneity-and-regression.html#building-the-geographically-weighted-model"><i class="fa fa-check"></i><b>13.3.2</b> Building the geographically weighted model</a></li>
<li class="chapter" data-level="13.3.3" data-path="spatial-heterogeneity-and-regression.html"><a href="spatial-heterogeneity-and-regression.html#using-gwr"><i class="fa fa-check"></i><b>13.3.3</b> Using GWR</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="spatial-heterogeneity-and-regression.html"><a href="spatial-heterogeneity-and-regression.html#summary-and-further-reading-9"><i class="fa fa-check"></i><b>13.4</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>14</b> Appendix: A quick intro to R and RStudio</a>
<ul>
<li class="chapter" data-level="14.1" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#exploring-rstudio"><i class="fa fa-check"></i><b>14.1</b> Exploring RStudio</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#the-four-panes-of-r-studio"><i class="fa fa-check"></i><b>14.1.1</b> The four panes of R Studio</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#customising-the-rstudio-look"><i class="fa fa-check"></i><b>14.2</b> Customising the RStudio look</a></li>
<li class="chapter" data-level="14.3" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#elements-of-r-grammar"><i class="fa fa-check"></i><b>14.3</b> Elements of R grammar</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#functions"><i class="fa fa-check"></i><b>14.3.1</b> Functions</a></li>
<li class="chapter" data-level="14.3.2" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#objects"><i class="fa fa-check"></i><b>14.3.2</b> Objects</a></li>
<li class="chapter" data-level="14.3.3" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#types-of-objects"><i class="fa fa-check"></i><b>14.3.3</b> Types of objects</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#packages"><i class="fa fa-check"></i><b>14.4</b> Packages</a></li>
<li class="chapter" data-level="14.5" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#exploring-data-with-r"><i class="fa fa-check"></i><b>14.5</b> Exploring data with R</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#playing-around-with-data"><i class="fa fa-check"></i><b>14.5.1</b> Playing around with data</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#getting-organised-r-projects"><i class="fa fa-check"></i><b>14.6</b> Getting organised: R Projects</a></li>
<li class="chapter" data-level="14.7" data-path="appendix-a-quick-intro-to-r-and-rstudio.html"><a href="appendix-a-quick-intro-to-r-and-rstudio.html#summary-and-further-reading-10"><i class="fa fa-check"></i><b>14.7</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html"><i class="fa fa-check"></i><b>15</b> Appendix B: Regression analysis (a refresher)</a>
<ul>
<li class="chapter" data-level="15.1" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#introduction-11"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#motivating-regression"><i class="fa fa-check"></i><b>15.2</b> Motivating regression</a></li>
<li class="chapter" data-level="15.3" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#fitting-a-simple-regression-model"><i class="fa fa-check"></i><b>15.3</b> Fitting a simple regression model</a></li>
<li class="chapter" data-level="15.4" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#residuals-revisited-r-squared"><i class="fa fa-check"></i><b>15.4</b> Residuals revisited: R squared</a></li>
<li class="chapter" data-level="15.5" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#inference-with-regression"><i class="fa fa-check"></i><b>15.5</b> Inference with regression</a></li>
<li class="chapter" data-level="15.6" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#fitting-regression-with-categorical-predictors"><i class="fa fa-check"></i><b>15.6</b> Fitting regression with categorical predictors</a></li>
<li class="chapter" data-level="15.7" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#motivating-multiple-regression"><i class="fa fa-check"></i><b>15.7</b> Motivating multiple regression</a></li>
<li class="chapter" data-level="15.8" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#fitting-and-interpreting-a-multiple-regression-model"><i class="fa fa-check"></i><b>15.8</b> Fitting and interpreting a multiple regression model</a></li>
<li class="chapter" data-level="15.9" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#presenting-your-regression-results."><i class="fa fa-check"></i><b>15.9</b> Presenting your regression results.</a></li>
<li class="chapter" data-level="15.10" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#rescaling-input-variables-to-assist-interpretation"><i class="fa fa-check"></i><b>15.10</b> Rescaling input variables to assist interpretation</a></li>
<li class="chapter" data-level="15.11" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#testing-conditional-hypothesis-interactions"><i class="fa fa-check"></i><b>15.11</b> Testing conditional hypothesis: interactions</a></li>
<li class="chapter" data-level="15.12" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#model-building-and-variable-selection"><i class="fa fa-check"></i><b>15.12</b> Model building and variable selection</a></li>
<li class="chapter" data-level="15.13" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#regression-assumptions"><i class="fa fa-check"></i><b>15.13</b> Regression assumptions</a></li>
<li class="chapter" data-level="15.14" data-path="appendix-b-regression-analysis-a-refresher.html"><a href="appendix-b-regression-analysis-a-refresher.html#summary-and-further-reading-11"><i class="fa fa-check"></i><b>15.14</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><i class="fa fa-check"></i><b>16</b> Appendix C: sourcing geographical data for crime analysis</a>
<ul>
<li class="chapter" data-level="16.1" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html#the-rnaturalearth-package"><i class="fa fa-check"></i><b>16.1</b> The rnaturalearth package</a></li>
<li class="chapter" data-level="16.2" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html#data-from-apis"><i class="fa fa-check"></i><b>16.2</b> Data from APIs</a></li>
<li class="chapter" data-level="16.3" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html#data-from-data-repositories"><i class="fa fa-check"></i><b>16.3</b> Data from data repositories</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html#international-resources"><i class="fa fa-check"></i><b>16.3.1</b> International resources</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html#open-street-map"><i class="fa fa-check"></i><b>16.4</b> Open Street Map</a></li>
<li class="chapter" data-level="16.5" data-path="appendix-c-sourcing-geographical-data-for-crime-analysis.html"><a href="appendix-c-sourcing-geographical-data-for-crime-analysis.html#summary-and-further-reading-12"><i class="fa fa-check"></i><b>16.5</b> Summary and further reading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Crime Mapping and Spatial Data Analysis using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="variations-of-thematic-mapping" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Variations of thematic mapping</h1>
<div id="introduction-3" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Introduction</h2>
<p>In this chapter we are going to discuss some additional features around thematic maps. Specifically, we will address some of the problems we confront when we are trying to use use choropleth maps, as well as some alternatives to point based maps. We will also briefly introduce the modifiable area unit problem.</p>
<p>The main objectives for this chapter are that by the end you will have:</p>
<ul>
<li>Explored <strong>binning</strong> as an alternative to point maps.</li>
<li>Been introduced to alternative visualisations of polygon-level data such as
<ul>
<li><strong>cartograms</strong>, and</li>
<li><strong>bi-variate</strong> thematic maps.</li>
</ul></li>
<li>Gained an insight into the <strong>Modifiable Areal Unit Problem</strong></li>
</ul>
<p>In this chapter, we will be making use of the following libraries:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="variations-of-thematic-mapping.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages for reading data and data carpentry</span></span>
<span id="cb185-2"><a href="variations-of-thematic-mapping.html#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb185-3"><a href="variations-of-thematic-mapping.html#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb185-4"><a href="variations-of-thematic-mapping.html#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb185-5"><a href="variations-of-thematic-mapping.html#cb185-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-6"><a href="variations-of-thematic-mapping.html#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages for handling spatial data and for geospatial carpentry</span></span>
<span id="cb185-7"><a href="variations-of-thematic-mapping.html#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb185-8"><a href="variations-of-thematic-mapping.html#cb185-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-9"><a href="variations-of-thematic-mapping.html#cb185-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages for mapping and visualisation</span></span>
<span id="cb185-10"><a href="variations-of-thematic-mapping.html#cb185-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb185-11"><a href="variations-of-thematic-mapping.html#cb185-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggspatial)</span>
<span id="cb185-12"><a href="variations-of-thematic-mapping.html#cb185-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb185-13"><a href="variations-of-thematic-mapping.html#cb185-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartogram)</span></code></pre></div>
</div>
<div id="binning-points" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Binning points</h2>
<p>In GIS it is often difficult to present point-based data because in many instances there are several different points and data symbologies that need to be shown. As the number of different data points grows they can become complicated to interpret and manage which can result in convoluted and sometimes inaccurate maps. This becomes an even larger problem in web maps that are able to be depicted at different scales because smaller scale maps need to show more area and more data. This makes the maps convoluted if multiple data points are included.</p>
<p>In many maps there are so many data points included that little can be interpreted from them. In order to reduce congestion on maps many GIS users and cartographers have turned to a process known as binning. Binning allows researchers and practitioners a way to systematically divide a region into equal-sized portions. As well as making maps with many points easier to read, binning data into regions can help identify spatial influence of neighbourhoods, and can be an essential step in developing systematic sampling designs.</p>
<p>This approach to binning generates an array of repeating shapes over a userspecified area. These shapes can be hexagons, squares, rectangles, triangles, circles or points, and they can be generated with any directional orientation. These are sometimes called ‘grids’ or ‘fishnets’ and lots of other spatial analysis (e.g., map algebra) can be done with such files.</p>
<div id="the-binning-process" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> The Binning Process</h3>
<p><strong>Binning</strong> is a data modification technique that changes the way data is shown at small scales. It is done in the pre-processing stage of data analysis to convert the original data values into a range of small intervals, known as a bin. These bins are then replaced by a value that is representative of the interval to reduce the number of data points.</p>
<p>Spatial binning (also called <em>spatial discretization</em>) discretizes the location values into a small number of groups associated with geographical areas or shapes. This approach to binning generates an array of repeating shapes over a user-specified area. These shapes can be hexagons, squares, rectangles, triangles, circles or points, and they can be generated with any directional orientation. The assignment of a location to a group can be done by any of the following methods:</p>
<ul>
<li>Using the coordinates of the point to identify which “bin” it belongs to.</li>
<li>Using a common variable in the attribute table of the bin and the point layers.</li>
</ul>
</div>
<div id="different-binning-techniques" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Different Binning Techniques</h3>
<p>Binning itself is a general term used to describe the grouping of a dataset’s values into smaller groups <span class="citation">(<a href="#ref-Johnson_2011" role="doc-biblioref">Johnson 2011</a>)</span>. The bins can be based on a variety of factors and attributes such as spatial and temporal and can thus be used for many different projects.</p>
<div id="choropleth-maps-1" class="section level4" number="5.2.2.1">
<h4><span class="header-section-number">5.2.2.1</span> Choropleth maps</h4>
<p>You might be thinking, “grouping points into a larger spatial unit, haven’t we already done this when making choropleth maps?” In a way you are right. Choropleth maps are a type of map that uses binning. Proportional symbol and choropleth maps group similar data points together to show a range of data instead of many individual points. We’ve covered this extensively, and is often the best approach to consider spatial grouping of your point variables, because the polygons (shapes) to which you are aggregating your points are <em>meaningful</em>. You can group into LSOAs, as we did in previous chapters, because you want to show variation in neighbourhoods. Or you can group into police force areas because you want to look at differences between those units of analysis. But sometimes there is just not a geography present to meet your needs.</p>
<p>Let’s say you are conducting some days of action in Manchester city centre, focusing on antisocial behaviour. You are going to put up some information booths and staff them with officers to engage with the local population about antisocial behaviour. For these to be most effective, as an analyst you decide that they should go into the areas with the highest <em>count</em> of antisocial behaviour. You want to be very specific about where you put these as well, and so LSOA level would be too broad, you want to zoom in more. One approach can be to split central Manchester into some smaller polygons, and just calculate the number of antisocial behaviour incidents recorded in each. That way you can then decide to put your information booths somewhere inside the top 5 highest count bins.</p>
</div>
<div id="rectangular-binning" class="section level4" number="5.2.2.2">
<h4><span class="header-section-number">5.2.2.2</span> Rectangular binning</h4>
<p>The aggregation of incident point data to regularly shaped grids is used for many reasons such as normalizing geography for mapping or to mitigate the issues of using irregularly shaped polygons created arbitrarily (such as county boundaries or block groups that have been created from a political process). Regularly shaped grids can only be comprised of equilateral triangles, squares, or hexagons, as these three polygon shapes are the only three that can tessellate (repeating the same shape over and over again, edge to edge, to cover an area without gaps or overlaps) to create an evenly spaced grid.</p>
<p>Rectangular binning is the simplest binning method and as such it heavily used. However, there are some reasons why rectangular bins are less preferable over hexagonal bins. Before we cover this, let’s have a look at hexagonal bins.</p>
</div>
<div id="hexagonal-binning" class="section level4" number="5.2.2.3">
<h4><span class="header-section-number">5.2.2.3</span> Hexagonal binning</h4>
<p>In many applications binning is done using a technique called <strong>hexagonal binning</strong>. This technique uses hexagon shapes to create a grid of points and develops a spatial histogram that shows different data points as a range or group of pairs with common distances and directions. In hexagonal binning the number of points falling within a particular hexagon in a gridded surface is what makes the different colors to easily visualize data <span class="citation">(<a href="#ref-Smith_2014" role="doc-biblioref">N. Smith 2014</a>)</span>. Hexagonnal binning was first developed in 1987 and today “hexbinning” is conducted by laying a hexagonal grid on top of 2-dimensional data <span class="citation">(<a href="#ref-Johnson_2011" role="doc-biblioref">Johnson 2011</a>)</span>. Once this is done users can conduct data point counts to determine the number of points for each hexagon <span class="citation">(<a href="#ref-Johnson_2011" role="doc-biblioref">Johnson 2011</a>)</span>. The bins are then symbolized differently to show meaningful patterns in the data.</p>
<p>So how can we use hexbinning to solve our antisocial behaviour days of action task? Well let’s say we split Manchester city centre into hexagons, and count the number of antisocial behaviour instances in these. We can then identify the top hexagons, and locate our booths somewhere within these.</p>
<p>First make sure you have the appropriate packages loaded. Also let’s get some data. You could go and get this data yourself from police.uk, but as we’ve been through a few times now, a tidied set of data is ready for you within the data provided with the book (see <em>Preamble</em>). This data is one year’s worth of antisocial behaviour from the <a href="data.police.uk">police.uk</a> data, from May 2016 to May 2017, for the borough of Manchester.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="variations-of-thematic-mapping.html#cb186-1" aria-hidden="true" tabindex="-1"></a>manchester_asb <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/manchester_asb.csv&quot;</span>)</span></code></pre></div>
<p>This is currently just a text dataframe, so we need to let R know that actually this is a spatial object; the geometry can be found in its longitude and latitude coordinates. As we have long/lat we can assume it’s in WGS 84 projection.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="variations-of-thematic-mapping.html#cb187-1" aria-hidden="true" tabindex="-1"></a>ma_spatial <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(manchester_asb, </span>
<span id="cb187-2"><a href="variations-of-thematic-mapping.html#cb187-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Latitude&quot;</span>),</span>
<span id="cb187-3"><a href="variations-of-thematic-mapping.html#cb187-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="dv">4326</span>, </span>
<span id="cb187-4"><a href="variations-of-thematic-mapping.html#cb187-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">agr =</span> <span class="st">&quot;constant&quot;</span>)</span></code></pre></div>
<p>Now one thing that this does is it consumes our Long and Lat columns into a geometry attribute. This is generally OK, but for the binning we will do, we would like to have them as separate coordinates. To do this, we can use the <code>st_coordinates()</code> function from the <code>sf</code> package. This function extracts the longitude and latitude from the geometry within the <code>sf</code> object, in this case “ma_spatial” object. For example, if we look at the first row:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="variations-of-thematic-mapping.html#cb188-1" aria-hidden="true" tabindex="-1"></a>ma_spatial <span class="sc">%&gt;%</span> </span>
<span id="cb188-2"><a href="variations-of-thematic-mapping.html#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb188-3"><a href="variations-of-thematic-mapping.html#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_coordinates</span>()</span></code></pre></div>
<pre><code>##        X     Y
## 1 -2.229 53.53</code></pre>
<p>We have our longitude (<code>X</code>) and latitude (<code>Y</code>). We can select the first and second element of this to get only one or the other. To go through our whole dataframe, we can use the <code>mutate()</code> function, and assign each element to a longitude and latitude column respectively:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="variations-of-thematic-mapping.html#cb190-1" aria-hidden="true" tabindex="-1"></a>ma_spatial <span class="ot">&lt;-</span> ma_spatial <span class="sc">%&gt;%</span> </span>
<span id="cb190-2"><a href="variations-of-thematic-mapping.html#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude =</span> <span class="fu">st_coordinates</span>(.)[,<span class="dv">1</span>],</span>
<span id="cb190-3"><a href="variations-of-thematic-mapping.html#cb190-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude =</span> <span class="fu">st_coordinates</span>(.)[,<span class="dv">2</span>])</span></code></pre></div>
<p>As a first step, we can plot antisocial behaviour in the borough of Manchester using simple <code>ggplot</code>, as demonstrated in Chapter 1. We can plot our points first:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="variations-of-thematic-mapping.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ma_spatial, <span class="fu">aes</span>(<span class="at">x =</span> longitude, <span class="at">y =</span> latitude)) <span class="sc">+</span></span>
<span id="cb191-2"><a href="variations-of-thematic-mapping.html#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">size=</span><span class="fl">0.001</span>) <span class="sc">+</span> </span>
<span id="cb191-3"><a href="variations-of-thematic-mapping.html#cb191-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-137"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-137-1.png" alt="Point map of ASB in Manchester" width="672" />
<p class="caption">
FIGURE 5.1: Point map of ASB in Manchester
</p>
</div>
<p>We see our nice map of Manchester, as outlined by ASB incidents across the Local Authority. However, it is hard to tell from this map where these incidents might occur more frequently and where they are just a few one-off incidents. A binned map may help us better understand. To create such a map, we must first create the grid (or fishnet) of tessellating shapes. Once we have this grid, we can overlay it on top of our map, and count the number of ASB incidents (points) which fall into each grid shape (polygon). We can use the <code>ggplot</code> library to achieve this. It is such a great tool for building visualisations, because you can apply whatever geometry best suits your data. To map a hexbinned version of our point data of antisocial behaviour, we can use the <code>stat_binhex()</code> function as a layer added on to our ggplot object. We can also recreate the thematic map element, as we can use the frequency of points in each hex to shade each hexbin from white (least number of incidents) to red (most number of incidents). So let’s have a go:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="variations-of-thematic-mapping.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define data and variables for x and y axes</span></span>
<span id="cb192-2"><a href="variations-of-thematic-mapping.html#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ma_spatial, <span class="fu">aes</span>(longitude, latitude)) <span class="sc">+</span> </span>
<span id="cb192-3"><a href="variations-of-thematic-mapping.html#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot geometry with geom_sf()</span></span>
<span id="cb192-4"><a href="variations-of-thematic-mapping.html#cb192-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span> </span>
<span id="cb192-5"><a href="variations-of-thematic-mapping.html#cb192-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#add binhex layer (hexbin) set bin size (in degrees)</span></span>
<span id="cb192-6"><a href="variations-of-thematic-mapping.html#cb192-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_binhex</span>(<span class="at">binwidth =</span> <span class="fu">c</span>(.<span class="dv">015</span>, .<span class="dv">01</span>)) <span class="sc">+</span></span>
<span id="cb192-7"><a href="variations-of-thematic-mapping.html#cb192-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#add shading based on number of ASB incidents</span></span>
<span id="cb192-8"><a href="variations-of-thematic-mapping.html#cb192-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>,<span class="st">&quot;red&quot;</span>),  <span class="at">name =</span> <span class="st">&quot;Frequency&quot;</span>)  <span class="sc">+</span> </span>
<span id="cb192-9"><a href="variations-of-thematic-mapping.html#cb192-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() </span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-138"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-138-1.png" alt="Hexbin map of ASB in Manchester" width="672" />
<p class="caption">
FIGURE 5.2: Hexbin map of ASB in Manchester
</p>
</div>
<p><em>Note: you might get the following prompt when you run this code: “The <code>hexbin</code> package is required for <code>stat_binhex()</code> Would you like to install it?” - if you do, just choose “Yes” or quit the action and install the <code>hexbin</code> package separately, and then try running the code again</em></p>
<p>Neat, but doesn’t quite tell us <em>where</em> that really dark hexbin actually is. So it would be much better if we could do this with a basemap as the background. For this we use the function <code>annotation_map_tile()</code> from the <code>ggspatial</code> package. We can also set the opacity of the binhex layer, so we can see our basemap, with the <code>alpha</code> parameter.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="variations-of-thematic-mapping.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ma_spatial, <span class="fu">aes</span>(<span class="at">x =</span> longitude, <span class="at">y =</span> latitude)) <span class="sc">+</span></span>
<span id="cb193-2"><a href="variations-of-thematic-mapping.html#cb193-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_map_tile</span>() <span class="sc">+</span> </span>
<span id="cb193-3"><a href="variations-of-thematic-mapping.html#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_binhex</span>(<span class="at">binwidth =</span> <span class="fu">c</span>(.<span class="dv">015</span>, .<span class="dv">01</span>), <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span>   <span class="co"># set opacity </span></span>
<span id="cb193-4"><a href="variations-of-thematic-mapping.html#cb193-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="at">name =</span> <span class="st">&quot;Frequency&quot;</span>)   <span class="sc">+</span> </span>
<span id="cb193-5"><a href="variations-of-thematic-mapping.html#cb193-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() </span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-139"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-139-1.png" alt="Hexbin map of ASB in Manchester with basemap" width="672" />
<p class="caption">
FIGURE 5.3: Hexbin map of ASB in Manchester with basemap
</p>
</div>
<p>Adding this basemap provides us with a bit more context. And combined with the hexbin map, it is much easier to see where in Manchester borough Antisocial Behaviour concentrates (as opposed to with the point map!). Above we used a hexagon shape for our binning, however you might choose other shapes as well. We will illustrate in a moment the approach to use rectangular binning, but first, we want to highlight why hexagon might still be your ideal choice. Here are some thoughts, summarised from <span class="citation">(<a href="#ref-ArcGIS_2021" role="doc-biblioref">ArcGIS Pro 2021</a>)</span>:</p>
<ul>
<li>Hexagons reduce sampling bias due to edge effects <span class="citation">(<a href="#ref-Rengert_2009" role="doc-biblioref">Rengert and Lockwood 2009</a>)</span> of the grid shape.</li>
<li>As hexagons are circular they represent curves in the patterns of your data more naturally than square grids.</li>
<li>When comparing polygons with equal areas, the more similar to a circle the polygon is, the closer to the centroid the points near the border are.</li>
<li>Hexagons are preferable when your analysis includes aspects of connectivity or movement paths. Due to the linear nature of rectangles, fishnet grids can draw our eyes to the straight, unbroken, parallel lines which may inhibit the underlying patterns in the data.</li>
<li>If you are working over a large area, a hexagon grid will suffer less distortion due to the curvature of the earth than the shape of a fishnet grid.</li>
<li>You will find more neighbours with hexagons than square grids, if you’re using a distance band, since the distance between centroids is the same in all six directions with hexagons (see image below).</li>
</ul>
<div class="figure"><span id="fig:unnamed-chunk-140"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-140-1.png" alt="Hexagonal bins will have more neighbors included in the calculations for each feature as opposed to a fishnet grid" width="672" />
<p class="caption">
FIGURE 5.4: Hexagonal bins will have more neighbors included in the calculations for each feature as opposed to a fishnet grid
</p>
</div>
<p>To illustrate the differences of different approaches. Like we did in earlier chapters, we can assign each map to an object, and then print them all side-by-side. Let’s start with rectangular binning:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="variations-of-thematic-mapping.html#cb194-1" aria-hidden="true" tabindex="-1"></a>rectangular_bin_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ma_spatial, <span class="fu">aes</span>(<span class="at">x =</span> longitude, <span class="at">y =</span> latitude)) <span class="sc">+</span> </span>
<span id="cb194-2"><a href="variations-of-thematic-mapping.html#cb194-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_map_tile</span>() <span class="sc">+</span> </span>
<span id="cb194-3"><a href="variations-of-thematic-mapping.html#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin2d</span>(<span class="at">binwidth =</span> <span class="fu">c</span>(.<span class="dv">015</span>, .<span class="dv">01</span>), <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb194-4"><a href="variations-of-thematic-mapping.html#cb194-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>,<span class="st">&quot;red&quot;</span>), </span>
<span id="cb194-5"><a href="variations-of-thematic-mapping.html#cb194-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span> </span>
<span id="cb194-6"><a href="variations-of-thematic-mapping.html#cb194-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p>Now map a map using hexagonal binning:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="variations-of-thematic-mapping.html#cb195-1" aria-hidden="true" tabindex="-1"></a>hexagonal_bin_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ma_spatial, <span class="fu">aes</span>(<span class="at">x =</span> longitude, <span class="at">y =</span> latitude)) <span class="sc">+</span> </span>
<span id="cb195-2"><a href="variations-of-thematic-mapping.html#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_map_tile</span>() <span class="sc">+</span> </span>
<span id="cb195-3"><a href="variations-of-thematic-mapping.html#cb195-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_binhex</span>(<span class="at">binwidth =</span> <span class="fu">c</span>(.<span class="dv">015</span>, .<span class="dv">01</span>), <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb195-4"><a href="variations-of-thematic-mapping.html#cb195-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>,<span class="st">&quot;red&quot;</span>), </span>
<span id="cb195-5"><a href="variations-of-thematic-mapping.html#cb195-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span> </span>
<span id="cb195-6"><a href="variations-of-thematic-mapping.html#cb195-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p>And finally for comparison simple “heatmap” (we will discuss these more thoroughly in Chapter 7):</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="variations-of-thematic-mapping.html#cb196-1" aria-hidden="true" tabindex="-1"></a>heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ma_spatial, <span class="fu">aes</span>(<span class="at">x =</span> longitude, <span class="at">y =</span> latitude)) <span class="sc">+</span> </span>
<span id="cb196-2"><a href="variations-of-thematic-mapping.html#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_map_tile</span>() <span class="sc">+</span> </span>
<span id="cb196-3"><a href="variations-of-thematic-mapping.html#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density2d</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ..level.., <span class="co"># value corresponding to </span></span>
<span id="cb196-4"><a href="variations-of-thematic-mapping.html#cb196-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="co"># discretized density estimates </span></span>
<span id="cb196-5"><a href="variations-of-thematic-mapping.html#cb196-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">alpha =</span> ..level..), </span>
<span id="cb196-6"><a href="variations-of-thematic-mapping.html#cb196-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">geom =</span> <span class="st">&quot;polygon&quot;</span>) <span class="sc">+</span>  <span class="co"># creates the bands of </span></span>
<span id="cb196-7"><a href="variations-of-thematic-mapping.html#cb196-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="co"># different colours</span></span>
<span id="cb196-8"><a href="variations-of-thematic-mapping.html#cb196-8" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Configure the colours, transparency and panel</span></span>
<span id="cb196-9"><a href="variations-of-thematic-mapping.html#cb196-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>,<span class="st">&quot;red&quot;</span>), </span>
<span id="cb196-10"><a href="variations-of-thematic-mapping.html#cb196-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span> </span>
<span id="cb196-11"><a href="variations-of-thematic-mapping.html#cb196-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha</span>(<span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb196-12"><a href="variations-of-thematic-mapping.html#cb196-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p>Now we can print them all side-by-side using <code>plot_grid()</code> function from the <code>cowplot</code> package to compare.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="variations-of-thematic-mapping.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb197-2"><a href="variations-of-thematic-mapping.html#cb197-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-3"><a href="variations-of-thematic-mapping.html#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(rectangular_bin_map, hexagonal_bin_map, heatmap, <span class="at">nrow =</span><span class="dv">1</span>, </span>
<span id="cb197-4"><a href="variations-of-thematic-mapping.html#cb197-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="st">&quot;AUTO&quot;</span>, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, .<span class="dv">85</span>))</span></code></pre></div>
<div class="figure"><span id="fig:comparehexrectheat"></span>
<img src="crime_mapping_files/figure-html/comparehexrectheat-1.png" alt="Comparing rectangular (A), hexagonal (B), and heat maps (C)" width="672" />
<p class="caption">
FIGURE 5.5: Comparing rectangular (A), hexagonal (B), and heat maps (C)
</p>
</div>
</div>
</div>
<div id="benefits-of-binning" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Benefits of Binning</h3>
<p>Because of the plethora of data types available and the wide variety of projects being done in GIS, binning is a popular method for mapping complex data and making it meaningful. Binning is a good option for map makers as well as users because it makes data easy to understand and it can be both static and interactive on many different map scales. If every different point were shown on a map it would have to be a very large scale map to ensure that the data points did not overlap and were easily understood by people using the maps. According to Kenneth Field, an Esri Research Cartographer:</p>
<blockquote>
<p>“Data binning is a great alternative for mapping large point-based data sets which allows us to tell a better story without interpolation. Binning is a way of converting point-based data into a regular grid of polygons so that each polygon represents the aggregation of points that fall within it” <span class="citation">(<a href="#ref-Field_2012b" role="doc-biblioref">Field 2012</a>)</span>.</p>
</blockquote>
<p>By using binning to create categories of data maps are easier to understand, more accurate and more visually appealing. Hexbin plots can be viewed as an alternative to scatter plots. The hexagon-shaped bins were introduced to plot densely packed sunflower plots. They can be used to plot scatter plots with high-density data.</p>
</div>
</div>
<div id="transforming-polygons-cartograms" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Transforming polygons: cartograms</h2>
<p>When you have meaningful spatial units of analysis in your polygons, for example you are interested specifically in Local Autorities, it might make sense to aggregate the points into these meaningful polygons to create thematic maps. However, while thematic maps are an accessible and visually appealing method for displaying spatial information, they can also be highly misleading. Irregularly shaped polygons and large differences in the size of areas being mapped can introduce misrepresentation. The message analysts and researchers want to get across might be lost, or even worse, misdirect the viewers to erroneous conclusions. <span class="citation"><a href="#ref-Field_2016" role="doc-biblioref">Field and Dorling</a> (<a href="#ref-Field_2016" role="doc-biblioref">2016</a>)</span> provide a helpful discussion of the problem illustrating the case with UK election maps. It is worth reading.</p>
<p>Fortunately, there are many methods in R to enhance the legibility of geographic information and the interpretability of what it is trying to be communicated. Selecting the appropriate method might depend on the research question being posed (e.g. clustering) and the data itself. Even once a method has been selected, there are different ways of operationalising them. Here we focus on <strong>cartograms</strong>. A cartogram is a method of distortion whereby distinct definable spatial regions on a map (e.g. countries, provinces, etc.) are distorted in some way through being weighted by some quantitative value (e.g. population count, carbon emissions, etc.) <span class="citation">(<a href="#ref-Kirk_2016" role="doc-biblioref">Kirk 2016</a>)</span>.</p>
<p>Let’s explore this using the example of the results of the 2016 EU referendum which took place in the United Kingdom, where citizens voted to leave the European Union (in a process termed “Brexit”). We can look at the data on voting results at Local Authority level. It is well known that those who voted to Remain in the EU predominantly clustered in the Local Authorities within London. A simple thematic map does not necessarily communicate this well because Local Authorities are both small and densely populated in London, compared to much larger elsewhere.</p>
<p>You can download the full set of EU referendum result data as a csv from <a href="https://www.electoralcommission.org.uk/find-information-by-subject/elections-and-referendums/past-elections-and-referendums/eu-referendum/eu-referendum-result-visualisations">the Electoral Commission webside</a>. We’ve already done this and included in our data supplied with the book. Let’s read it straight into R:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="variations-of-thematic-mapping.html#cb198-1" aria-hidden="true" tabindex="-1"></a>eu_ref <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/EU-referendum-result-data.csv&quot;</span>)</span></code></pre></div>
<p>We also need a spatial object to join our attribute table to, in order to map it. In <em>Appendix C: Sourcing geographical data for crime analysis</em> we detail how one might go about finding such spatial data, if it is not already provided. For now, we can use the data which comes with this book from the supplementary materials. Specifically the shapefile for English Local Authorities. This file is called <code>england_lad_2011_gen.shp</code> and is found in the <code>England_lad_2011_gen</code> subfolder.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="variations-of-thematic-mapping.html#cb199-1" aria-hidden="true" tabindex="-1"></a>las <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/England_lad_2011_gen/england_lad_2011_gen.shp&quot;</span>)</span></code></pre></div>
<p>We can now join the EU referendum data using the attribute operation <code>left_join()</code>, as we have illustrated in detail in Chapter 1.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="variations-of-thematic-mapping.html#cb200-1" aria-hidden="true" tabindex="-1"></a>eu_sf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(las, eu_ref, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;name&quot;</span> <span class="ot">=</span> <span class="st">&quot;Area&quot;</span>))</span>
<span id="cb200-2"><a href="variations-of-thematic-mapping.html#cb200-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-3"><a href="variations-of-thematic-mapping.html#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="co">#make sure we are in British National Grid Projection</span></span>
<span id="cb200-4"><a href="variations-of-thematic-mapping.html#cb200-4" aria-hidden="true" tabindex="-1"></a>eu_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(eu_sf, <span class="dv">27700</span>)</span></code></pre></div>
<p>Now we can have a look at these data:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="variations-of-thematic-mapping.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb201-2"><a href="variations-of-thematic-mapping.html#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> eu_sf, <span class="fu">aes</span>(<span class="at">fill =</span> Pct_Leave)) <span class="sc">+</span> </span>
<span id="cb201-3"><a href="variations-of-thematic-mapping.html#cb201-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-147"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-147-1.png" alt="EU referendum results across Local Authorit (no transformation)" width="672" />
<p class="caption">
FIGURE 5.6: EU referendum results across Local Authorit (no transformation)
</p>
</div>
<p>The Local Authorities (LAs) vary greatly in their shape and size, and in the case of smaller LAs the result is barely visible. In this case, we cannot really see what was happening with the EU referendum in London, for example. This is the sort of situation where augmenting our polygons may be handy. Cartograms offer one way to achieve this.</p>
<p>There are different types of cartograms. <strong>Density-equalizing (contiguous) cartograms</strong> are your traditional cartograms. In density-equalizing cartograms, map features bulge out a specific variable. Even though it distorts each feature, it remains connected during its creation. On the other hand, you can have <strong>Non-Contiguous Cartograms</strong>, where features in non-contiguous cartograms don’t have to stay connected. Finally, <strong>Dorling Cartograms</strong> (named after professor Danny Dorling <span class="citation">(<a href="#ref-Dorling_1991" role="doc-biblioref">Dorling 1991</a>)</span>) use shapes like circles and rectangles to depict areas. These types of cartograms make it easy to recognize patterns.</p>
<p>We can explore cartograms using the <code>cartogram</code> package. Within that we will use the <code>cartogram()</code> function. In this function, we will specify two parameters: first the <code>shp =</code>, which asks for the shape file (it can be a SpatialPolygonDataFrame or an sf object), and second, <code>weight =</code>, which asks for the variable which it should use to distort the polygon by.</p>
<p>In our data set we have a variable <code>Electorate</code> which refers to the total number of registered electors in that Local Authority. It serves to give an indicator of the total number of people who were eligible to vote in the referendum. We can use this variable to distort our polygons and create our cartogram.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="variations-of-thematic-mapping.html#cb202-1" aria-hidden="true" tabindex="-1"></a>eu_cartogram <span class="ot">&lt;-</span> <span class="fu">cartogram_cont</span>(eu_sf, <span class="st">&quot;Electorate&quot;</span>)</span></code></pre></div>
<p>If you run this, it might take a long time. This function, while it looks nice and simple, is actually very computationally taxing for your computer. For those interested, you may like to take the time while R works this out for you to read up on the maths behind this transformation in <span class="citation"><a href="#ref-Dougenik_1985" role="doc-biblioref">Dougenik, Chrisman, and Niemeyer</a> (<a href="#ref-Dougenik_1985" role="doc-biblioref">1985</a>)</span> (it’s got a fun name: a rubber sheet distortion algorithm!).</p>
<p>I do have a tip for you if you want to make sure the process does not take too long. You can set another parameter in the cartogram function which is the <code>itermax=</code> parameter. This specifies the maximum number of iterations we are happy to sit through for our cartogram. If you do not specify an alternative the defaukt is set to 15. Let’s set to 5 for the sake of speed:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="variations-of-thematic-mapping.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construct a cartogram using the percentage voting leave</span></span>
<span id="cb203-2"><a href="variations-of-thematic-mapping.html#cb203-2" aria-hidden="true" tabindex="-1"></a>eu_cartogram <span class="ot">&lt;-</span> <span class="fu">cartogram_cont</span>(eu_sf, <span class="st">&quot;Electorate&quot;</span>, <span class="at">itermax =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>This will be faster (but may not result in the best possible cartogram output). Once your cartogram has been created, you can now plot again the referendum results, but using the electorate to change the size of the Local Authority:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="variations-of-thematic-mapping.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb204-2"><a href="variations-of-thematic-mapping.html#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> eu_cartogram, <span class="fu">aes</span>(<span class="at">fill =</span> Pct_Leave)) <span class="sc">+</span> </span>
<span id="cb204-3"><a href="variations-of-thematic-mapping.html#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-150"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-150-1.png" alt="Cartogram weightin each polygon (Local Authority) by the size of its electorate" width="672" />
<p class="caption">
FIGURE 5.7: Cartogram weightin each polygon (Local Authority) by the size of its electorate
</p>
</div>
<p>We can now see London much better, and see that darker coloured cluster where a much smaller percentage of people voted leave. We can eye-ball where London may be, as this continuous area cartogram tries to maintain some fidelity to our original shapes, while weighting them by some variable of interest, in our case the electorate in each Local Authority.</p>
<div id="dorling-cartogram" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Dorling Cartogram</h3>
<p>While the continuous area cartogram we created above tries to maintain some fidelity to our original shapes, other approaches take more freedom when applying transformations. Sometimes, maintaining a resemblance to the original geometry of each polygon may not be important. In that case, you might be interested in creating a <strong>Dorling cartogram</strong>. We can achieve this by using the <code>cartogram_dorling()</code> function. Again we specify the sf object, and the variable which we use to scale our areas.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="variations-of-thematic-mapping.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construct a Dorling cartogram using the percentage voting leave</span></span>
<span id="cb205-2"><a href="variations-of-thematic-mapping.html#cb205-2" aria-hidden="true" tabindex="-1"></a>eu_dorling_cartogram <span class="ot">&lt;-</span> <span class="fu">cartogram_dorling</span>(eu_sf, <span class="st">&quot;Electorate&quot;</span>)</span></code></pre></div>
<p>Let’s plot the output:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="variations-of-thematic-mapping.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb206-2"><a href="variations-of-thematic-mapping.html#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> eu_dorling_cartogram, <span class="fu">aes</span>(<span class="at">fill =</span> Pct_Leave)) <span class="sc">+</span> </span>
<span id="cb206-3"><a href="variations-of-thematic-mapping.html#cb206-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-152"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-152-1.png" alt="Dorling cartogram of LAs by electorate size" width="672" />
<p class="caption">
FIGURE 5.8: Dorling cartogram of LAs by electorate size
</p>
</div>
<p>This map has transformed each Local Authority’s shape into a circle, where the radius is determined as a function of the variable we supplied, which is our Electorate in each LA. The shading here is again provided by the percentage of people who voted to leave in each area, with lighter values indicating more people voting to leave, and darker values indicating fewer people voting to leave the EU. However, the relations of these Local Authorities is tough to maintain here, and we may be hard-pressed to identify London’s boroughs out of this collection. However, Dorling cartograms may have their use and place. You may read up more about them in <span class="citation"><a href="#ref-Dorling_1996" role="doc-biblioref">Dorling</a> (<a href="#ref-Dorling_1996" role="doc-biblioref">1996</a>)</span>.</p>
</div>
</div>
<div id="bivariate-maps" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Bivariate Maps</h2>
<p>Usually in your thematic maps you are mapping one variable. In the distortion examples above, we incorporate a second variable in order to make the map more legible. However, occasionally, you might want to use your map to illustrate the relationship between <em>two</em> variables. In this case, you may want to create a <strong>Bivariate Choropleth Map</strong>. Bivariate choropleths follow the same concept as the univariate ones (which display only one variable), except they show two variables at once. This is achieved through the creative use of colour.</p>
<p>We first came across the idea of bivariate choropleth maps from the blog of <span class="citation"><a href="#ref-Stevens_2015" role="doc-biblioref">Stevens</a> (<a href="#ref-Stevens_2015" role="doc-biblioref">2015</a>)</span>. we recommend having a read as he discusses in great detail how to develop the colour schemes necessary for these maps. The idea is that there are two main colours, each one representing gradual change in one of our two variables of interest. Then, these two colours are combined to create an overlapping colour scheme.</p>
<p>The process itself is not too complicated. We start with binning our two variables into classes. If we bin variable 1 into <span class="math inline">\(n\)</span> classes, and then again variable 2 into <span class="math inline">\(n\)</span> classes, then when we compare them across one another to create our bivariate map, we will end up with <span class="math inline">\(n^2\)</span> classes. For example, if we bin both variables into 3 classes (low, medium, high), then when displaying them together, we will have 9 classes to visualise. <span class="citation"><a href="#ref-Stevens_2015" role="doc-biblioref">Stevens</a> (<a href="#ref-Stevens_2015" role="doc-biblioref">2015</a>)</span> blog illustrates with nice visuals, so we recommend having a look. However the practical example is in QGIS, and here we are working in R. There had been adaptations into R (eg see <span class="citation"><a href="#ref-Grossenbacher_2019" role="doc-biblioref">Grossenbacher</a> (<a href="#ref-Grossenbacher_2019" role="doc-biblioref">2019</a>)</span>) which we can borrow from here too.</p>
<p>Creating the map boils down to 5 key steps. First, we take our two variables of interest, and create bins. Second, we create a new variable, which we will use for the shading. Third we create our colour scheme. Fourth, we join this to our <code>sf</code> object. And, finally we map! Let’s go through these steps now. Using the example of voting to leave the EU.</p>
<p>It may be an interesting question to look into not only how the voting outcome was distributed (<code>Pct_Leave</code>) but how this varies with voter turnout (<code>Pct_Turnout</code>). We might be interested in areas with high turnout and high percentage voting to leave, as these may be areas where people felt passionately. On the other hand, other areas may have had low turnout, which may have influenced the result, and in those places, how did people who did turn up vote? These are the kinds of questions we can answer with a bivariate map.</p>
<div id="step-1-bin-our-variables-of-interest" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Step 1: Bin our variables of interest</h3>
<p>We are interested in two key variables, <code>Pct_Leave</code> - the percentage of people who voted to leave the EU, and <code>Pct_Turnout</code> - the percentage of the electorate who actually voted. These are both numeric continuous variables. In order to create our bivariate choropleth map, we have to bin these values into <span class="math inline">\(n\)</span> discrete categories. Here let’s go with <span class="math inline">\(n = 3\)</span>.</p>
<p>We can use the <code>cut()</code> and the <code>quantile()</code> functions in base R to class our variable into three quantiles. The <code>quantile()</code> function identifies the sample quantiles in a continuous variable. We need to include the parameters <code>x=</code>: the numeric vector whose sample quantiles are wanted (in this case our variables <code>Pct_Leave</code> and <code>Pct_Turnout</code>), and <code>probs=</code>: numeric vector of probabilities with values in [0,1]. We can use the sequence generator function <code>seq()</code> to generate these from 0 to 1, by the increment of <span class="math inline">\(\frac{1}{3}\)</span> for 3 groups.</p>
<p>So first, let’s create the breaks first for the <code>Pct_Leave</code> variable.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="variations-of-thematic-mapping.html#cb207-1" aria-hidden="true" tabindex="-1"></a>leave_breaks <span class="ot">&lt;-</span> <span class="fu">quantile</span>(eu_sf<span class="sc">$</span>Pct_Leave, </span>
<span id="cb207-2"><a href="variations-of-thematic-mapping.html#cb207-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="co"># probabilities</span></span>
<span id="cb207-3"><a href="variations-of-thematic-mapping.html#cb207-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="co"># remove NAs </span></span>
<span id="cb207-4"><a href="variations-of-thematic-mapping.html#cb207-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">names=</span><span class="cn">TRUE</span>, <span class="co"># keep names attribute</span></span>
<span id="cb207-5"><a href="variations-of-thematic-mapping.html#cb207-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">include.lowest=</span><span class="cn">TRUE</span>) <span class="co"># include value equal to </span></span>
<span id="cb207-6"><a href="variations-of-thematic-mapping.html#cb207-6" aria-hidden="true" tabindex="-1"></a>                                              <span class="co"># lowest ‘breaks’ value </span></span></code></pre></div>
<p>And then the same again but for the turnout variable <code>Pct_Turnout</code>.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="variations-of-thematic-mapping.html#cb208-1" aria-hidden="true" tabindex="-1"></a>turnout_breaks <span class="ot">&lt;-</span> <span class="fu">quantile</span>(eu_sf<span class="sc">$</span>Pct_Turnout, </span>
<span id="cb208-2"><a href="variations-of-thematic-mapping.html#cb208-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), </span>
<span id="cb208-3"><a href="variations-of-thematic-mapping.html#cb208-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">na.rm=</span><span class="cn">TRUE</span>, </span>
<span id="cb208-4"><a href="variations-of-thematic-mapping.html#cb208-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">names=</span><span class="cn">TRUE</span>, </span>
<span id="cb208-5"><a href="variations-of-thematic-mapping.html#cb208-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">include.lowest=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>We can have a look at the output:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="variations-of-thematic-mapping.html#cb209-1" aria-hidden="true" tabindex="-1"></a>leave_breaks</span></code></pre></div>
<pre><code>##     0% 33.33% 66.67%   100% 
##  21.38  51.72  59.12  75.56</code></pre>
<p>The results are the cutoff values which we want to use to “cut” our numeric variable. We do this with the <code>cut()</code> function, where we specify again what to cut (the variables <code>Pct_Leave</code> and <code>Pct_Turnout</code>), and the breaks at which to cut (the objects we created above, <code>leave_breaks</code> and <code>turnout_breaks</code>):</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="variations-of-thematic-mapping.html#cb211-1" aria-hidden="true" tabindex="-1"></a>eu_sf <span class="ot">&lt;-</span> eu_sf <span class="sc">%&gt;%</span> </span>
<span id="cb211-2"><a href="variations-of-thematic-mapping.html#cb211-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">leave_quantiles =</span> <span class="fu">cut</span>(Pct_Leave, </span>
<span id="cb211-3"><a href="variations-of-thematic-mapping.html#cb211-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">breaks =</span> leave_breaks), </span>
<span id="cb211-4"><a href="variations-of-thematic-mapping.html#cb211-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">turnout_quantiles =</span> <span class="fu">cut</span>(Pct_Turnout, </span>
<span id="cb211-5"><a href="variations-of-thematic-mapping.html#cb211-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">breaks =</span> turnout_breaks))</span></code></pre></div>
<p>We have two resulting variables, <code>leave_quantiles</code> and <code>turnout_quantiles</code> which classify each one of our observations into one of these quartiles for both the variables. In the next step, we use these to create a new variable.</p>
</div>
<div id="step-2-new-variable" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Step 2: New variable</h3>
<p>In this step we create a new variable. This time let’s call it <code>group</code>, which tells us which quartile the specific Local Authority (each row) falls into. By applying the <code>as.numeric()</code> function we translate the ranges of the quartile into their label (i.e. 1, 2, or 3rd quartile). We do this for both variables, and paste them together using the <code>paste()</code> function, and the separator “-”:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="variations-of-thematic-mapping.html#cb212-1" aria-hidden="true" tabindex="-1"></a>eu_sf <span class="ot">&lt;-</span> eu_sf <span class="sc">%&gt;%</span> </span>
<span id="cb212-2"><a href="variations-of-thematic-mapping.html#cb212-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">paste</span>(</span>
<span id="cb212-3"><a href="variations-of-thematic-mapping.html#cb212-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(turnout_quantiles), <span class="st">&quot;-&quot;</span>,</span>
<span id="cb212-4"><a href="variations-of-thematic-mapping.html#cb212-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(leave_quantiles))</span>
<span id="cb212-5"><a href="variations-of-thematic-mapping.html#cb212-5" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p>We now have a new column, called group, which tells us for each Local Authority, which quartile it falls into for each variable. For example, a value of “1 - 1” means the Local Authority belongs to the first quartile in both variables. This area would be considered to have low percent voting leave, and also low turnout. On the other hand, “3 - 1” means that there was high turnout, but a low percentage voted to leave. We use this variable to assign the appropriate colour for our colour scheme for each of the <span class="math inline">\(3^2\)</span> (9) combinations.</p>
</div>
<div id="step-3-create-colour-scheme" class="section level3" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Step 3: Create colour scheme</h3>
<p>Picking a colour scheme which reflects both gradual change in each individual variable, and the combined change in both is not an easy task! Luckily <span class="citation"><a href="#ref-Stevens_2015" role="doc-biblioref">Stevens</a> (<a href="#ref-Stevens_2015" role="doc-biblioref">2015</a>)</span> has created some scale recommendations for us to choose from. we copy two of them below, but you can see the blog for another 2 options.</p>
<p>In this code below, we simply specify for each of the 9 values of the variable created in the previous step (“1 - 1,” “1 - 2,” “1 - 3,” “2 - 1,” … “3 - 3” ) an associated colour using the relevant hex code.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="variations-of-thematic-mapping.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb213-2"><a href="variations-of-thematic-mapping.html#cb213-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-3"><a href="variations-of-thematic-mapping.html#cb213-3" aria-hidden="true" tabindex="-1"></a>bivariate_color_scale_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb213-4"><a href="variations-of-thematic-mapping.html#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;3 - 3&quot;</span> <span class="ot">=</span> <span class="st">&quot;#574249&quot;</span>, <span class="co"># high - high </span></span>
<span id="cb213-5"><a href="variations-of-thematic-mapping.html#cb213-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2 - 3&quot;</span> <span class="ot">=</span> <span class="st">&quot;#985356&quot;</span>,</span>
<span id="cb213-6"><a href="variations-of-thematic-mapping.html#cb213-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;1 - 3&quot;</span> <span class="ot">=</span> <span class="st">&quot;#c85a5a&quot;</span>, <span class="co"># low - high </span></span>
<span id="cb213-7"><a href="variations-of-thematic-mapping.html#cb213-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;3 - 2&quot;</span> <span class="ot">=</span> <span class="st">&quot;#627f8c&quot;</span>,</span>
<span id="cb213-8"><a href="variations-of-thematic-mapping.html#cb213-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2 - 2&quot;</span> <span class="ot">=</span> <span class="st">&quot;#ad9ea5&quot;</span>, <span class="co"># medium - medium </span></span>
<span id="cb213-9"><a href="variations-of-thematic-mapping.html#cb213-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;1 - 2&quot;</span> <span class="ot">=</span> <span class="st">&quot;#e4acac&quot;</span>,</span>
<span id="cb213-10"><a href="variations-of-thematic-mapping.html#cb213-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;3 - 1&quot;</span> <span class="ot">=</span> <span class="st">&quot;#64acbe&quot;</span>, <span class="co"># high - low </span></span>
<span id="cb213-11"><a href="variations-of-thematic-mapping.html#cb213-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2 - 1&quot;</span> <span class="ot">=</span> <span class="st">&quot;#b0d5df&quot;</span>,</span>
<span id="cb213-12"><a href="variations-of-thematic-mapping.html#cb213-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;1 - 1&quot;</span> <span class="ot">=</span> <span class="st">&quot;#e8e8e8&quot;</span> <span class="co"># low - low </span></span>
<span id="cb213-13"><a href="variations-of-thematic-mapping.html#cb213-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb213-14"><a href="variations-of-thematic-mapping.html#cb213-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="st">&quot;group&quot;</span>, <span class="st">&quot;fill_col&quot;</span>)</span>
<span id="cb213-15"><a href="variations-of-thematic-mapping.html#cb213-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-16"><a href="variations-of-thematic-mapping.html#cb213-16" aria-hidden="true" tabindex="-1"></a>bivariate_color_scale_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb213-17"><a href="variations-of-thematic-mapping.html#cb213-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;3 - 3&quot;</span> <span class="ot">=</span> <span class="st">&quot;#3b4994&quot;</span>, <span class="co"># high - high </span></span>
<span id="cb213-18"><a href="variations-of-thematic-mapping.html#cb213-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2 - 3&quot;</span> <span class="ot">=</span> <span class="st">&quot;#5698b9&quot;</span>,</span>
<span id="cb213-19"><a href="variations-of-thematic-mapping.html#cb213-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;1 - 3&quot;</span> <span class="ot">=</span> <span class="st">&quot;#5ac8c8&quot;</span>, <span class="co"># low - high </span></span>
<span id="cb213-20"><a href="variations-of-thematic-mapping.html#cb213-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;3 - 2&quot;</span> <span class="ot">=</span> <span class="st">&quot;#8c62aa&quot;</span>,</span>
<span id="cb213-21"><a href="variations-of-thematic-mapping.html#cb213-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2 - 2&quot;</span> <span class="ot">=</span> <span class="st">&quot;#a5add3&quot;</span>, <span class="co"># medium - medium </span></span>
<span id="cb213-22"><a href="variations-of-thematic-mapping.html#cb213-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;1 - 2&quot;</span> <span class="ot">=</span> <span class="st">&quot;#ace4e4&quot;</span>,</span>
<span id="cb213-23"><a href="variations-of-thematic-mapping.html#cb213-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;3 - 1&quot;</span> <span class="ot">=</span> <span class="st">&quot;#be64ac&quot;</span>, <span class="co"># high - low </span></span>
<span id="cb213-24"><a href="variations-of-thematic-mapping.html#cb213-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2 - 1&quot;</span> <span class="ot">=</span> <span class="st">&quot;#dfb0d6&quot;</span>,</span>
<span id="cb213-25"><a href="variations-of-thematic-mapping.html#cb213-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;1 - 1&quot;</span> <span class="ot">=</span> <span class="st">&quot;#e8e8e8&quot;</span> <span class="co"># low - low </span></span>
<span id="cb213-26"><a href="variations-of-thematic-mapping.html#cb213-26" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb213-27"><a href="variations-of-thematic-mapping.html#cb213-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="st">&quot;group&quot;</span>, <span class="st">&quot;fill_col&quot;</span>)</span></code></pre></div>
<p>You can have a look at both of these, and see which one you like. Feel free to use either in your future bivariate mapping adventures. Or construct your own, perhaps following the two additional ones provided by <span class="citation"><a href="#ref-Stevens_2015" role="doc-biblioref">Stevens</a> (<a href="#ref-Stevens_2015" role="doc-biblioref">2015</a>)</span>, or some entirely new ones you may have constructed.</p>
</div>
<div id="step-4-join-colour-scheme" class="section level3" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> Step 4: Join colour scheme</h3>
<p>Now that we have a colour scheme, we can join to the spatial object, using <code>left_join()</code>. The common element is the <code>group</code> variable, so with this approach, we join the relevant colour to each value of group in that column. Let’s join <code>bivariate_color_scale_2</code>, the second of the two we created above.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="variations-of-thematic-mapping.html#cb214-1" aria-hidden="true" tabindex="-1"></a>eu_sf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(eu_sf, bivariate_color_scale_2, <span class="at">by =</span> <span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<p>We now have an additional column in our <code>eu_sf</code> dataframe, called <code>fill_col</code> which we can use to shade each local authority according to the composite variable depicting % who voted to leave and % who turned up to vote.</p>
</div>
<div id="step-5-create-legend" class="section level3" number="5.4.5">
<h3><span class="header-section-number">5.4.5</span> Step 5: Create legend</h3>
<p>The legend is a little tricky, as we need to separate out the values into separate Leave and Turnout columns. We can achieve this with the <code>separate()</code> function</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="variations-of-thematic-mapping.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># separate the groups</span></span>
<span id="cb215-2"><a href="variations-of-thematic-mapping.html#cb215-2" aria-hidden="true" tabindex="-1"></a>bivariate_color_scale <span class="ot">&lt;-</span> bivariate_color_scale_2 <span class="sc">%&gt;%</span></span>
<span id="cb215-3"><a href="variations-of-thematic-mapping.html#cb215-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(group,  <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;Pct_Turnout&quot;</span>, <span class="st">&quot;Pct_Leave&quot;</span>), <span class="at">sep =</span> <span class="st">&quot; - &quot;</span>)</span></code></pre></div>
<p>Then to create the legend, we actually build a <code>ggplot()</code> object. This genius bit of code is borrowed from <span class="citation"><a href="#ref-Grossenbacher_2019" role="doc-biblioref">Grossenbacher</a> (<a href="#ref-Grossenbacher_2019" role="doc-biblioref">2019</a>)</span> implementation of bivariate choropleth maps.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="variations-of-thematic-mapping.html#cb216-1" aria-hidden="true" tabindex="-1"></a>legend <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb216-2"><a href="variations-of-thematic-mapping.html#cb216-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>( <span class="at">data =</span> bivariate_color_scale, </span>
<span id="cb216-3"><a href="variations-of-thematic-mapping.html#cb216-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Pct_Turnout, <span class="at">y =</span> Pct_Leave, <span class="at">fill =</span> fill_col)) <span class="sc">+</span></span>
<span id="cb216-4"><a href="variations-of-thematic-mapping.html#cb216-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb216-5"><a href="variations-of-thematic-mapping.html#cb216-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Higher % turnout -&gt;&quot;</span>,</span>
<span id="cb216-6"><a href="variations-of-thematic-mapping.html#cb216-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Higher % voted leave -&gt;&quot;</span>) <span class="sc">+</span></span>
<span id="cb216-7"><a href="variations-of-thematic-mapping.html#cb216-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>)) <span class="sc">+</span> <span class="co"># makes text small for </span></span>
<span id="cb216-8"><a href="variations-of-thematic-mapping.html#cb216-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="co"># adding legend to map</span></span>
<span id="cb216-9"><a href="variations-of-thematic-mapping.html#cb216-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()  <span class="co"># forces a specified ratio to create quadratic tiles</span></span></code></pre></div>
<p>This code returns the legend as a chart itself. Have a look what it looks like:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="variations-of-thematic-mapping.html#cb217-1" aria-hidden="true" tabindex="-1"></a>legend</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-162"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-162-1.png" alt="Legend for bivariate map" width="672" />
<p class="caption">
FIGURE 5.9: Legend for bivariate map
</p>
</div>
</div>
<div id="step-6-map" class="section level3" number="5.4.6">
<h3><span class="header-section-number">5.4.6</span> Step 6: Map</h3>
<p>Now finally we put it all on the map. For the choropleth map, we use our variable <code>fill_col</code> which contains the matched colour to the group that each observation belongs to. We pass this in the familiar <code>geom_sf()</code> geometry and use the <code>fill=</code> parameter to colour the Local Authorities according to their turnout / voted leave combination. We also have to add the <code>scale_fill_identity()</code> function, as the values in the <code>fill_col</code> variable are actually the hex codes for the colour which we use to shade the Local Authorities.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="variations-of-thematic-mapping.html#cb218-1" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(eu_sf) <span class="sc">+</span></span>
<span id="cb218-2"><a href="variations-of-thematic-mapping.html#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>( <span class="at">fill =</span> fill_col)) <span class="sc">+</span></span>
<span id="cb218-3"><a href="variations-of-thematic-mapping.html#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span> </span>
<span id="cb218-4"><a href="variations-of-thematic-mapping.html#cb218-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p>Finally, to display the legend and the map together, we can use the <code>ggdraw()</code> and <code>draw_plot()</code> functions from the <code>cowplot</code> package.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="variations-of-thematic-mapping.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb219-2"><a href="variations-of-thematic-mapping.html#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdraw</span>() <span class="sc">+</span></span>
<span id="cb219-3"><a href="variations-of-thematic-mapping.html#cb219-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_plot</span>(map, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb219-4"><a href="variations-of-thematic-mapping.html#cb219-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_plot</span>(legend, <span class="fl">0.05</span>, <span class="fl">0.075</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>) </span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-164"></span>
<img src="crime_mapping_files/figure-html/unnamed-chunk-164-1.png" alt="Bivariate choropleth map of voter turnout and % who voted to leave the EU" width="672" />
<p class="caption">
FIGURE 5.10: Bivariate choropleth map of voter turnout and % who voted to leave the EU
</p>
</div>
<p>This map may now be able to provide insight into spatial patterns in turnout and voting to leave. For example, in the South you can see lots of pink, representing areas of high turnout and low % voting to leave the EU. You can also spot the dark blue areas, these are Local Authorities which saw high voter turnout and a high proportion voting to leave.</p>
<p>Overall these maps can help visualise two variables on one map, and motivate discussion about relationships between variables in different places.</p>
<!-- ## Dasymetric maps -->
<!-- A **dasymetric map** is a method of thematic mapping in which a choropleth map is refined by incorporating additional geographic information. In a dasymetric map, boundaries are modified to conform to known areas of homogeneity and are not restricted to administrative or statistical boundaries.  -->
<!-- These maps are one answer to the many inherent issues that choropleth maps display due to the arbitrary nature of their boundaries. One of these issues is the **Modifiable Area Unit Problem** which we will discuss at the end of this chapter in a bit more detail. Another issue is the **Ecological Fallacy** which has to do with assuming homogeneity within a specific area, and using area-level characteristics to draw conclusions about individuals/ smaller units of analysis than what was measured.  -->
<!-- The dasymetric technique uses geographic information about the distribution of the phenomenon of interest to refine the district boundaries so they better reflect the real-world patterns. The resultant map is somewhere between a choropleth map and an Isarithmic map (covered in Chapter 7).  -->
<!-- To create a dasymetric map, we first create a traditonal choropleth map, which we then augment using ping involves modifying existing choropleth map data using supporting data. This is somewhat similar to creating the cartograms we practiced earlier.  -->
</div>
</div>
<div id="a-note-of-caution-maup" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> A note of caution: MAUP</h2>
<p>Now that we’ve shown you how to do a lot of spatial crime analysis, we wanted to close with some words of caution. Remember that everything you’ve learned here are just tools that you will be applying to data you are working with, but it’s up to you, the researcher, the analyst, the domain expert, to apply and use these with careful consideration and cautions. This discussion is very much part of spatial crime analysis, and an important field of thought.</p>
<p>We borrow here from George Rengert and Brian Lockwood:</p>
<blockquote>
<p>“When spatial analysis of crime is conducted, the analyst should not ignore the spatial units that data are aggregated into and the impact of this choice on the interpretation of findings. Just as several independent variables are considered to determine whether they have statistical significance, a consideration of multiple spatial units of analysis should be made as well, in order to determine whether the choice of aggregation level used in a spatial analysis can result in biased findings” <span class="citation">(<a href="#ref-Rengert_2009" role="doc-biblioref">Rengert and Lockwood 2009</a>, p. )</span>.</p>
</blockquote>
<p>In particular, they highlight four main issues inherent in most studies of space:</p>
<ul>
<li>issues associated with politically bounded units of aggregation,</li>
<li>edge effects of bounded space</li>
<li>the modifiable areal unit problem (MAUP)</li>
<li>and ways in which the results of statistical analyses can be manipulated by changes in the level of
aggregation.</li>
</ul>
<div id="scale" class="section level4" number="5.5.0.1">
<h4><span class="header-section-number">5.5.0.1</span> Scale</h4>
<p>The scale problem involves results that change based on data that are analyzed at higher or lower levels of aggregation (changing the number of units). For example, evaluating data at the state level vs. Census tract level.</p>
<p>The scale problem has moved to the forefront of geographical criminology as a result of the recent interest in small-scale geographical units of analysis. It has been suggested that smaller is better since small areas can be directly perceived by individuals and are likely to be more homogenous than larger areas <span class="citation">(<a href="#ref-Gerell_2017" role="doc-biblioref">Gerell 2017</a>)</span>.</p>
</div>
<div id="zone" class="section level4" number="5.5.0.2">
<h4><span class="header-section-number">5.5.0.2</span> Zone</h4>
<p>The zonal problem involves keeping the same scale of research (say, at the state level) but changing the actual shape and size of those areas.</p>
<p>The basic issue with the MAUP is that aggregate units of analysis are often arbitrarily produced by whom ever is in charge of creating the aggregate units. A classic example of this problem is known as Gerrymandering. Gerrymandering involves shaping and re-shaping voting districts based on the political affiliations of the resident citizenry.</p>
<p>The inherent problem with the MAUP and with situations such as Gerrymandering is that units of analysis are not based on geographic principles, and instead are based on political and social biases. For researchers and analysts the MAUP has very important implications for research findings because it is possible that as arbitrarily defined units of analysis change shape findings based on these units will change as well.</p>
<p>When spatial data are derived from counting or averaging data within areal units, the form of those areal units affects the data recorded, and any statistical measures derived from the data. Modifying the areal units therefore changes the data. Two effects are involved: a zoning effect arising from the particular choice of areas at a given scale; and an aggregation effect arising from the extent to which data are aggregated over smaller or larger areas. The modifiable areal unit problem arises in part from edge effect. If you’re interested, in particular about politics and voting, you can read this interesting piece by <span class="citation"><a href="#ref-Bycoffe_2018" role="doc-biblioref">Bycoffe et al.</a> (<a href="#ref-Bycoffe_2018" role="doc-biblioref">2018</a>)</span> to learn more about gerrymandering.</p>
</div>
<div id="why-does-maup-matter" class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Why does MAUP matter?</h3>
<p>The practical implications of MAUP are immense for almost all decision-making processes involving mapping technology, since with the availability of aggregated maps, policy could easily focus on issues and problems which might look different if the aggregation scheme used were changed.</p>
<p>All studies based on geographical areas are susceptible to MAUP. The implications of the MAUP affect potentially any area level data, whether direct measures or complex model-based estimates. Here are a few examples of situations where the MAUP is expected to make a difference, taken from <span class="citation"><a href="#ref-Gerell_2017" role="doc-biblioref">Gerell</a> (<a href="#ref-Gerell_2017" role="doc-biblioref">2017</a>)</span>.</p>
<ul>
<li>The special case of the ecological fallacy is always present when Census area data are used to formulate and evaluate policies that address problems at individual level, such as deprivation. Also, it is recognised that a potential source of error in the analysis of Census data is ‘the arrangement of continuous space into defined regions for purposes of data reporting’</li>
<li>The MAUP has an impact on indices derived from areal data, such as measures of segregation, which can change significantly as a result of using different geographical levels of analysis to derive composite measures .</li>
<li>The choice of boundaries for reporting ratios is not without consequences: when the areas are too small, the values estimated are unstable, while when the areas are too large, the values reported may be over-smoothed, i.e. meaningful variation may be lost.</li>
</ul>
</div>
<div id="what-can-we-do" class="section level3" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> What can we do?</h3>
<p>Most often you will just have to remain aware of the MAUP and its possible effects. There are some techniques, that can help you address these issues, and the chapter pointed out at the beginning of this section is a great place to start to explore these. It is possible toalso use an alternative, zone-free approach to mapping these crime patterns, perhaps by using kernel density estimation. Here we model the relative density of the points as a density surface - essentially a function of location (x,y) representing the relative likelihood of occurrence of an event at that point. We cover KDE in Chapter 7 of this book.</p>
<p>For now, it’s enough that you know of, and understand the MAUP and its implications. Always be smart when choosing your appropriate spatial unit of analysis, and when you use binning of any form, make sure you consider how and if your conclusions might change compared to another possible approach.</p>
</div>
</div>
<div id="summary-and-further-reading-3" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Summary and further reading</h2>
<p>In this chapter we explored the use of binning points into hexbins and rectangular grids, as well as transforming polygons in order to enhance the legibility of your maps. For some more information on binning see <span class="citation"><a href="#ref-Johnson_2011" role="doc-biblioref">Johnson</a> (<a href="#ref-Johnson_2011" role="doc-biblioref">2011</a>)</span>. For transforming polygons, read <span class="citation"><a href="#ref-Tobler_2004" role="doc-biblioref">Tobler</a> (<a href="#ref-Tobler_2004" role="doc-biblioref">2004</a>)</span> and <span class="citation"><a href="#ref-Nusrat_2016" role="doc-biblioref">Nusrat and Kobourov</a> (<a href="#ref-Nusrat_2016" role="doc-biblioref">2016</a>)</span>. We can also suggest a read of <span class="citation"><a href="#ref-Langton_2021" role="doc-biblioref">Langton and Solymosi</a> (<a href="#ref-Langton_2021" role="doc-biblioref">2021</a>)</span> and check out this video from SAGE methods by <span class="citation"><a href="#ref-Solymosi_2021" role="doc-biblioref">Solymosi</a> (<a href="#ref-Solymosi_2021" role="doc-biblioref">2021</a>)</span>.</p>
<p>To read up more on the Modifiable Areal Unit Problem (MAUP) in general, we recommend the original <span class="citation"><a href="#ref-Openshaw_1981" role="doc-biblioref">Openshaw</a> (<a href="#ref-Openshaw_1981" role="doc-biblioref">1981</a>)</span>. For some criminology/ crime mapping specific reading try <span class="citation"><a href="#ref-Rengert_2009" role="doc-biblioref">Rengert and Lockwood</a> (<a href="#ref-Rengert_2009" role="doc-biblioref">2009</a>)</span> and <span class="citation"><a href="#ref-Gerell_2017" role="doc-biblioref">Gerell</a> (<a href="#ref-Gerell_2017" role="doc-biblioref">2017</a>)</span>.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ArcGIS_2021" class="csl-entry">
ArcGIS Pro. 2021. <span>“Why Hexagons?”</span> <a href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-statistics/h-whyhexagons.htm">https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-statistics/h-whyhexagons.htm</a>.
</div>
<div id="ref-Bycoffe_2018" class="csl-entry">
Bycoffe, Aaron, Ella Koeze, David Wasserman, and Julia Wolfe. 2018. <span>“The Atlas of Redistricting.”</span> <a href="https://projects.fivethirtyeight.com/redistricting-maps/">https://projects.fivethirtyeight.com/redistricting-maps/</a>.
</div>
<div id="ref-Dorling_1991" class="csl-entry">
Dorling, Daniel. 1991. <span>“The Visualisation of Spatial Social Structure.”</span> PhD thesis, University of Newcastle upon Tyne PhD thesis.
</div>
<div id="ref-Dorling_1996" class="csl-entry">
———. 1996. <span>“Area Cartograms: Their Use and Creation, Concepts and Techniques in Modern Geography.”</span>
</div>
<div id="ref-Dougenik_1985" class="csl-entry">
Dougenik, James, Nicholas Chrisman, and Duane Niemeyer. 1985. <span>“An Algorithm to Construct Continuous Area Cartograms.”</span> <em>The Professional Geographer</em> 37 (1): 75–81.
</div>
<div id="ref-Field_2012b" class="csl-entry">
———. 2012. <span>“Using a Binning Technique for Point-Based Multiscale Web Maps.”</span> <a href="https://www.esri.com/arcgis-blog/products/arcgis-online/mapping/using-a-binning-technique-for-point-based-multiscale-web-maps/">https://www.esri.com/arcgis-blog/products/arcgis-online/mapping/using-a-binning-technique-for-point-based-multiscale-web-maps/</a>.
</div>
<div id="ref-Field_2016" class="csl-entry">
Field, Kenneth, and Daniel Francis Luke Dorling. 2016. <span>“UK Election Cartography.”</span> <em>International Journal of Cartography</em> 2: 202–32.
</div>
<div id="ref-Gerell_2017" class="csl-entry">
Gerell, Manne. 2017. <span>“Smallest Is Better? The Spatial Distribution of Arson and the Modifiable Areal Unit Problem.”</span> <em>Journal of Quantitative Criminology</em> 33 (2): 293–318.
</div>
<div id="ref-Grossenbacher_2019" class="csl-entry">
Grossenbacher, Timo. 2019. <span>“Bivariate Maps with Ggplot2 and Sf.”</span> Blog. Tamedia. <a href="https://timogrossenbacher.ch/2019/04/bivariate-maps-with-ggplot2-and-sf/">https://timogrossenbacher.ch/2019/04/bivariate-maps-with-ggplot2-and-sf/</a>.
</div>
<div id="ref-Johnson_2011" class="csl-entry">
Johnson, Zachary-Forest. 2011. <span>“Hexbins!”</span> <a href="http://indiemaps.com/blog/2011/10/hexbins/">http://indiemaps.com/blog/2011/10/hexbins/</a>.
</div>
<div id="ref-Kirk_2016" class="csl-entry">
Kirk, Andy. 2016. <em>Data Visualisation: A Handbook for Data Driven Design</em>. London, UK: Sage.
</div>
<div id="ref-Langton_2021" class="csl-entry">
———. 2021. <span>“Cartograms, Hexograms and Regular Grids: Minimising Misrepresentation in Spatial Data Visualisations.”</span> <em>Environment and Planning B: Urban Analytics and City Science</em> 48 (2): 348–57.
</div>
<div id="ref-Nusrat_2016" class="csl-entry">
Nusrat, Sabrina, and Stephen Kobourov. 2016. <span>“The State of the Art in Cartograms.”</span> In <em>Computer Graphics Forum</em>, 35:619–42. 3. Wiley Online Library.
</div>
<div id="ref-Openshaw_1981" class="csl-entry">
Openshaw, Stan. 1981. <span>“The Modifiable Areal Unit Problem.”</span> <em>Quantitative Geography: A British View</em>, 60–69.
</div>
<div id="ref-Rengert_2009" class="csl-entry">
Rengert, George, and Brian Lockwood. 2009. <span>“Geographical Units of Analysis and the Analysis of Crime.”</span> In <em>Putting Crime in Its Place</em>, edited by David Weisburd, Wim Bernasco, and Gerben J. N. Bruinsma, 109–22. New York, NY: Springer.
</div>
<div id="ref-Smith_2014" class="csl-entry">
Smith, Nate. 2014. <span>“Binning: An Alternative to Point Maps.”</span> <a href="https://blog.mapbox.com/binning-an-alternative-to-point-maps-2cfc7b01d2ed">https://blog.mapbox.com/binning-an-alternative-to-point-maps-2cfc7b01d2ed</a>.
</div>
<div id="ref-Solymosi_2021" class="csl-entry">
Solymosi, Reka. 2021. <span>“Minimizing Misrepresentation in Spatial Data Visualizations.”</span> <a href="https://www.doi.org/10.4135/9781529774047">https://www.doi.org/10.4135/9781529774047</a>.
</div>
<div id="ref-Stevens_2015" class="csl-entry">
Stevens, Joshua. 2015. <span>“Bivariate Choropleth Maps: A How-to Guide.”</span> Blog. NASA’s Earth Observatory. <a href="https://www.joshuastevens.net/cartography/make-a-bivariate-choropleth-map/">https://www.joshuastevens.net/cartography/make-a-bivariate-choropleth-map/</a>.
</div>
<div id="ref-Tobler_2004" class="csl-entry">
Tobler, Waldo. 2004. <span>“Thirty Five Years of Computer Cartograms.”</span> <em>ANNALS of the Association of American Geographers</em> 94 (1): 58–73.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mapping-rates-and-counts.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basics-of-cartographic-design-elements-of-a-map.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/04-thematic_maps_2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["crime_mapping.pdf", "crime_mapping.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
